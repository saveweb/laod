<h1 id="title">大量Netgear(网件)路由器存在密码绕过漏洞，你家是否中枪？</h1>
<time id="date" datetime="2017-02-04T19:34:17+08:00">2017-02-04 19:34</time>
<section id="content">
    <p>
        <b
            >对于使用Netgear路由器的消费者来说，坏消息这段时间真是接踵而至。新年之际，Netgear路由器又遭遇一起严重安全漏洞，影响范围包括数十种路由器型号。</b
        >
    </p>
    <p>
        这个漏洞是Trustwave蜘蛛实验室的研究专家Simon
        Kenin发现的，因为Netgear路由器的密码恢复流程存在缺陷，入侵者可以利用这个漏洞远程获取Netgear路由器的管理员密码。
    </p>
    <p>
        <b
            >据Trustwave的安全专家警告：受这个身份验证漏洞影响的潜在用户超过百万，涉及至少31款不同型号的Netgear路由器。</b
        >
    </p>
    <p>
        <a href="https://laod.cn/wp-content/uploads/2017/02/Netgear.png"
            ><noscript
                ><img
                    class="alignnone size-full wp-image-2887"
                    src="https://laod.cn/wp-content/uploads/2017/02/Netgear.png"
                    alt="Netgear"
                    width="688"
                    height="373" /></noscript
            ><img
                class="alignnone size-full wp-image-2887 j-lazy"
                src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20688%20373'%3E%3C/svg%3E"
                data-original="https://laod.cn/wp-content/uploads/2017/02/Netgear.png"
                alt="Netgear"
                width="688"
                height="373"
                data-lazy-src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png" /><noscript
                ><img
                    class="alignnone size-full wp-image-2887 j-lazy"
                    src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png"
                    data-original="https://laod.cn/wp-content/uploads/2017/02/Netgear.png"
                    alt="Netgear"
                    width="688"
                    height="373" /></noscript
        ></a>
    </p>
    <h2>一步一步感染你的路由器</h2>
    <p>
        Kenin发现这个漏洞（CVE-2017-5521）也是机缘巧合，他在试图访问管理页面的时候发现自己忘记了Netgear路由器密码。
    </p>
    <p>
        Kenin于是开始想办法入侵自己的路由器，他用的是从2014年就开始采用的一些漏洞利用方法，通过一些简单的步骤的就能查询并获取用户的登录凭证，得到路由器的完整控制权限。
    </p>
    <p>
        但据Kenin所说，这个新漏洞只有在路由器的远程管理选项启用的情况下才能被利用。
    </p>
    <p>
        虽然路由器供应商声称远程管理路由器这个选项是默认关闭的，但Kenin发现，就算不超过百万，也有成千上万的路由器是可以远程访问的，存在被入侵的风险。
    </p>
    <blockquote>
        <p>
            Kenin说：“就算因为默认设置，远程管理路由器的选项是关闭的。但是在本地通过路由器物理访问网络的人都可以利用这个漏洞，像是咖啡馆或图书馆这样的公共Wi-Fi区域。”
        </p>
    </blockquote>
    <p>
        <a href="https://laod.cn/wp-content/uploads/2017/02/token.jpg"
            ><noscript
                ><img
                    class="alignnone size-full wp-image-2888"
                    src="https://laod.cn/wp-content/uploads/2017/02/token.jpg"
                    alt="token"
                    width="678"
                    height="383" /></noscript
            ><img
                class="alignnone size-full wp-image-2888 j-lazy"
                src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20678%20383'%3E%3C/svg%3E"
                data-original="https://laod.cn/wp-content/uploads/2017/02/token.jpg"
                alt="token"
                width="678"
                height="383"
                data-lazy-src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png" /><noscript
                ><img
                    class="alignnone size-full wp-image-2888 j-lazy"
                    src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png"
                    data-original="https://laod.cn/wp-content/uploads/2017/02/token.jpg"
                    alt="token"
                    width="678"
                    height="383" /></noscript
        ></a>
    </p>
    <p>
        <b
            >用户试图访问路由器的web控制界面时，就需要进行身份验证；如果身份验证被取消，同时密码恢复功能被禁用了，用户就会被重定向到一个页面，而这个页面会暴露密码恢复的token。如果用户能够给页面passwordrecovered.cgi?id=TOKEN（保证密码恢复功能禁用）提供正确的token，就能获取到路由器管理员密码。</b
        >
    </p>
    <p>
        <a href="https://laod.cn/wp-content/uploads/2017/02/Netgear1.jpg"
            ><noscript
                ><img
                    class="alignnone size-full wp-image-2889"
                    src="https://laod.cn/wp-content/uploads/2017/02/Netgear1.jpg"
                    alt="Netgear"
                    width="1470"
                    height="150" /></noscript
            ><img
                class="alignnone size-full wp-image-2889 j-lazy"
                src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%201470%20150'%3E%3C/svg%3E"
                data-original="https://laod.cn/wp-content/uploads/2017/02/Netgear1.jpg"
                alt="Netgear"
                width="1470"
                height="150"
                data-lazy-src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png" /><noscript
                ><img
                    class="alignnone size-full wp-image-2889 j-lazy"
                    src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png"
                    data-original="https://laod.cn/wp-content/uploads/2017/02/Netgear1.jpg"
                    alt="Netgear"
                    width="1470"
                    height="150" /></noscript
        ></a>
    </p>
    <p>
        当然，如果密码恢复功能被启用的话，这种攻击方式就不会成功，因为入侵者将被问到之前所设置的安全问题，就算在之后再将密码恢复功能禁用了，也不可避免要去回答问题。
    </p>
    <p>
        入侵者可以利用这个漏洞绕过Netgear路由器密码，在取得路由器的完全控制权之后，入侵者就能对路由器进行配置、将其变成僵尸网络、更甚者可以上传全新固件。
    </p>
    <p>
        在Kenin测试了一系列Netgear路由器之后，发现竟然有超过一万台设备使用了存在漏洞的固件，让入侵者可以远程访问。
    </p>
    <p>
        出于测试目的，Kenin用Python语言写了漏洞监测代码，<a
            href="https://www.trustwave.com/Resources/Security-Advisories/Advisories/TWSL2017-003/?fid=8911"
            target="_blank"
            >点击这里查看</a
        >。
    </p>
    <h2>存在漏洞的Netgear路由器型号一览</h2>
    <p>
        Kenin一再强调漏洞的严重性，并说明目前已经有多种型号的Netgear路由器受灾。以下是受影响的路由器型号：
    </p>
    <blockquote>
        <p>R8500</p>
        <p>R8300</p>
        <p>R7000</p>
        <p>R6400</p>
        <p>R7300DST</p>
        <p>R7100LG</p>
        <p>R6300v2</p>
        <p>WNDR3400v3</p>
        <p>WNR3500Lv2</p>
        <p>R6250</p>
        <p>R6700</p>
        <p>R6900</p>
        <p>R8000</p>
        <p>R7900</p>
        <p>WNDR4500v2</p>
        <p>R6200v2</p>
        <p>WNDR3400v2</p>
        <p>D6220</p>
        <p>D6400</p>
        <p>C6300 (firmware released to ISPs)</p>
    </blockquote>
    <h2>现在就更新路由器固件</h2>
    <p>
        Trustwave于2016年4月就向Netgear报告了这一漏洞，但是Netgear在7月份才为部分型号的路由提提供了更新固件。
    </p>
    <p>
        <a href="https://laod.cn/wp-content/uploads/2017/02/Trustwave.png"
            ><noscript
                ><img
                    class="alignnone size-full wp-image-2890"
                    src="https://laod.cn/wp-content/uploads/2017/02/Trustwave.png"
                    alt="Trustwave"
                    width="1200"
                    height="627" /></noscript
            ><img
                class="alignnone size-full wp-image-2890 j-lazy"
                src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%201200%20627'%3E%3C/svg%3E"
                data-original="https://laod.cn/wp-content/uploads/2017/02/Trustwave.png"
                alt="Trustwave"
                width="1200"
                height="627"
                data-lazy-src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png" /><noscript
                ><img
                    class="alignnone size-full wp-image-2890 j-lazy"
                    src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png"
                    data-original="https://laod.cn/wp-content/uploads/2017/02/Trustwave.png"
                    alt="Trustwave"
                    width="1200"
                    height="627" /></noscript
        ></a>
    </p>
    <p>
        Netgear已经公布了所有受感染型号路由器的更新固件，强烈建议用户尽快更新自己的设备。但是据安全专家所说，存在漏洞的31种型号的路由器中，Netgear暂时只为其中18款提供了补丁。
    </p>
    <p>
        使用其他型号的用户最好采用手动启用密码恢复并且禁用路由器的远程管理功能。
    </p>
    <p>
        这已经是两个月内第二次有研究人员发现Netgear路由器的漏洞了。就在上个月，Netgear多个型号路由器曝远程任意命令注入漏洞的事件Freebuf在之前的资讯中已有详细报道。为了让自己的产品更加安全，Netgear与Bugcrowd合作推出了一个漏洞赏金计划，能够发现并报告关于硬件、APIs和移动app漏洞的研究人员最高可获得15,000美元奖金。
    </p>
    <div class="entry-copyright">
        <p>
            原创文章，作者：老D，如若转载，请注明出处：https://laod.cn/news/netgear-trustwave.html
        </p>
    </div>
</section>
