<h1 id="title">Google漏洞可伪造域名邮箱钓鱼</h1>
<time id="date" datetime="2015-03-12T03:20:12+08:00">2015-03-12 03:20</time>
<section id="content">
    <p>
        <strong
            >近日Google Apps for
            Work曝出一个漏洞，攻击者可以利用该漏洞伪造任意网站的域名邮箱，冒充公司雇员给受害人发送钓鱼邮件。</strong
        >
    </p>
    <p>
        <a
            href="https://laod.cn/wp-content/uploads/2015/03/Google-Apps-for-Work.png"
            ><noscript
                ><img
                    class="aligncenter wp-image-416 size-full"
                    title="Google Apps for Work"
                    src="https://laod.cn/wp-content/uploads/2015/03/Google-Apps-for-Work.png"
                    alt="Google Apps for Work"
                    width="723"
                    height="394" /></noscript
            ><img
                class="aligncenter wp-image-416 size-full j-lazy"
                title="Google Apps for Work"
                src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20723%20394'%3E%3C/svg%3E"
                data-original="https://laod.cn/wp-content/uploads/2015/03/Google-Apps-for-Work.png"
                alt="Google Apps for Work"
                width="723"
                height="394"
                data-lazy-src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png" /><noscript
                ><img
                    class="aligncenter wp-image-416 size-full j-lazy"
                    title="Google Apps for Work"
                    src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png"
                    data-original="https://laod.cn/wp-content/uploads/2015/03/Google-Apps-for-Work.png"
                    alt="Google Apps for Work"
                    width="723"
                    height="394" /></noscript
        ></a>
    </p>
    <p><strong>Google的域名邮箱服务</strong></p>
    <p>
        <a
            class="__yjs_email__"
            href="/cdn-cgi/l/email-protection"
            data-yjsemail="5ebbf8dcb8c0c2bae3feb8ddedbbe2dabae6debae6f4b9efe5bae2e23f3a3337301e31312626703d3133b9c4da1a1707b7dcf0b9f0efb8c3fbbae5fdb8c5e119333f"
            >[email&nbsp;protected]</a
        >
        <script data-yjshash="f9e31" type="text/javascript">
            /* <![CDATA[ */ !(function (t, e, r, n, c, a, p) {
                try {
                    t =
                        document.currentScript ||
                        (function () {
                            for (
                                t = document.getElementsByTagName("script"),
                                    e = t.length;
                                e--;

                            )
                                if (t[e].getAttribute("data-yjshash"))
                                    return t[e];
                        })();
                    if (t && (c = t.previousSibling)) {
                        p = t.parentNode;
                        if ((a = c.getAttribute("data-yjsemail"))) {
                            for (
                                e = "", r = ("0x" + a.substr(0, 2)) | 0, n = 2;
                                a.length - n;
                                n += 2
                            )
                                e +=
                                    "%" +
                                    (
                                        "0" +
                                        (("0x" + a.substr(n, 2)) ^ r).toString(
                                            16
                                        )
                                    ).slice(-2);
                            p.replaceChild(
                                document.createTextNode(decodeURIComponent(e)),
                                c
                            );
                        }
                        p.removeChild(t);
                    }
                } catch (u) {}
            })(); /* ]]> */
        </script>
        il，那么你就可以试试在Google Apps for Work注册个账户。
    </p>
    <p>
        从Google服务中获取一个自定义的域名电子邮箱，只需要注册一个gmail账户。一旦创建账户以后，你可以通过Google应用提供的相应接口，直接操作你的域名管理面板。当然，只有你从在Google那里取得域名认证后，才能正常使用域名邮箱服务。
    </p>
    <p><strong>伪造域名邮箱钓鱼</strong></p>
    <p>
        安全研究人员Patrik fehrenbach和Behrouz
        sadeghipour发现，攻击者可以通过Google任意注册一个域名邮箱，只要它没有在Google应用服务中使用过。
    </p>
    <p>
        正常情况下，在你域名认证完成之前，<a
            class="__yjs_email__"
            href="/cdn-cgi/l/email-protection"
            data-yjsemail="c483ababa3a8a1207c4920785e2c6a6d207964226967217c7c20797b23506ca5a0a9adaa84ababbcbceaa7aba9207d4f23757f235e40808d9d2d466a236a75274446"
            >[email&nbsp;protected]</a
        >
        <script data-yjshash="f9e31" type="text/javascript">
            /* <![CDATA[ */ !(function (t, e, r, n, c, a, p) {
                try {
                    t =
                        document.currentScript ||
                        (function () {
                            for (
                                t = document.getElementsByTagName("script"),
                                    e = t.length;
                                e--;

                            )
                                if (t[e].getAttribute("data-yjshash"))
                                    return t[e];
                        })();
                    if (t && (c = t.previousSibling)) {
                        p = t.parentNode;
                        if ((a = c.getAttribute("data-yjsemail"))) {
                            for (
                                e = "", r = ("0x" + a.substr(0, 2)) | 0, n = 2;
                                a.length - n;
                                n += 2
                            )
                                e +=
                                    "%" +
                                    (
                                        "0" +
                                        (("0x" + a.substr(n, 2)) ^ r).toString(
                                            16
                                        )
                                    ).slice(-2);
                            p.replaceChild(
                                document.createTextNode(decodeURIComponent(e)),
                                c
                            );
                        }
                        p.removeChild(t);
                    }
                } catch (u) {}
            })(); /* ]]> */
        </script>
        但Google应用的某个页面存在一个漏洞：Google上注册的域名管理者无论是否进行了域名认证，都可以发送一个“登录指令”（Sign
        in Instructions）给域名邮箱成员，<a
            class="__yjs_email__"
            href="/cdn-cgi/l/email-protection"
            data-yjsemail="3adc95aedf9cb853545c557a5555424214595557d9bab8"
            >[email&nbsp;protected]</a
        >
        <script data-yjshash="f9e31" type="text/javascript">
            /* <![CDATA[ */ !(function (t, e, r, n, c, a, p) {
                try {
                    t =
                        document.currentScript ||
                        (function () {
                            for (
                                t = document.getElementsByTagName("script"),
                                    e = t.length;
                                e--;

                            )
                                if (t[e].getAttribute("data-yjshash"))
                                    return t[e];
                        })();
                    if (t && (c = t.previousSibling)) {
                        p = t.parentNode;
                        if ((a = c.getAttribute("data-yjsemail"))) {
                            for (
                                e = "", r = ("0x" + a.substr(0, 2)) | 0, n = 2;
                                a.length - n;
                                n += 2
                            )
                                e +=
                                    "%" +
                                    (
                                        "0" +
                                        (("0x" + a.substr(n, 2)) ^ r).toString(
                                            16
                                        )
                                    ).slice(-2);
                            p.replaceChild(
                                document.createTextNode(decodeURIComponent(e)),
                                c
                            );
                        }
                        p.removeChild(t);
                    }
                } catch (u) {}
            })(); /* ]]> */
        </script>
    </p>
    <p>
        <strong
            ><a
                class="__yjs_email__"
                href="/cdn-cgi/l/email-protection"
                data-yjsemail="6c89e9e489eadf8af1cd88d7da89dcdd8af4c384c3c989f3f389fce185eec28bc2dd8bf8c48ae4db89d3e985cdd78af4c389f0c48ac1c888d5e789e5e18adfc489ea"
                >[email&nbsp;protected]</a
            >
            <script data-yjshash="f9e31" type="text/javascript">
                /* <![CDATA[ */ !(function (t, e, r, n, c, a, p) {
                    try {
                        t =
                            document.currentScript ||
                            (function () {
                                for (
                                    t = document.getElementsByTagName("script"),
                                        e = t.length;
                                    e--;

                                )
                                    if (t[e].getAttribute("data-yjshash"))
                                        return t[e];
                            })();
                        if (t && (c = t.previousSibling)) {
                            p = t.parentNode;
                            if ((a = c.getAttribute("data-yjsemail"))) {
                                for (
                                    e = "",
                                        r = ("0x" + a.substr(0, 2)) | 0,
                                        n = 2;
                                    a.length - n;
                                    n += 2
                                )
                                    e +=
                                        "%" +
                                        (
                                            "0" +
                                            (
                                                ("0x" + a.substr(n, 2)) ^
                                                r
                                            ).toString(16)
                                        ).slice(-2);
                                p.replaceChild(
                                    document.createTextNode(
                                        decodeURIComponent(e)
                                    ),
                                    c
                                );
                            }
                            p.removeChild(t);
                        }
                    } catch (u) {}
                })(); /* ]]> */
            </script>
            的，构造的url请求如下：</strong
        >
    </p>
    <blockquote>
        <pre
            class="prettyprint lang-html prettyprinted"
        ><span class="pln">https:<a class="__yjs_email__" href="/cdn-cgi/l/email-protection" data-yjsemail="a58a8ac4c1c8cccb8bc2cacac2c9c08bc6cac88ae0c8c4ccc9e9cac2cccbeccbd6d1d7d0c6d1cccacbd69ad0d6c0d7e0c8c4ccc998cccbc3cae5c9c4cac18bc6cb">[email&nbsp;protected]</a><script data-yjshash="f9e31" type="text/javascript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-yjshash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-yjsemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script></span></pre>
    </blockquote>
    <p>
        利用该特定的email接口，攻击者可以伪造域名邮箱，发送任意包含恶意链接的钓鱼邮件给受害目标，然后骗取他们的私密信息诸如密码、商业信息等等。
    </p>
    <p>
        <strong
            >如下图所示，<a
                class="__yjs_email__"
                href="/cdn-cgi/l/email-protection"
                data-yjsemail="0cea98b7e98bb7e48c89ea849ce98693e98a9ee989896d686165624c7a656269226f6361"
                >[email&nbsp;protected]</a
            >
            <script data-yjshash="f9e31" type="text/javascript">
                /* <![CDATA[ */ !(function (t, e, r, n, c, a, p) {
                    try {
                        t =
                            document.currentScript ||
                            (function () {
                                for (
                                    t = document.getElementsByTagName("script"),
                                        e = t.length;
                                    e--;

                                )
                                    if (t[e].getAttribute("data-yjshash"))
                                        return t[e];
                            })();
                        if (t && (c = t.previousSibling)) {
                            p = t.parentNode;
                            if ((a = c.getAttribute("data-yjsemail"))) {
                                for (
                                    e = "",
                                        r = ("0x" + a.substr(0, 2)) | 0,
                                        n = 2;
                                    a.length - n;
                                    n += 2
                                )
                                    e +=
                                        "%" +
                                        (
                                            "0" +
                                            (
                                                ("0x" + a.substr(n, 2)) ^
                                                r
                                            ).toString(16)
                                        ).slice(-2);
                                p.replaceChild(
                                    document.createTextNode(
                                        decodeURIComponent(e)
                                    ),
                                    c
                                );
                            }
                            p.removeChild(t);
                        }
                    } catch (u) {}
                })(); /* ]]> */
            </script>
            （现已被Twitter收购）发送钓鱼邮件给受害人，骗取他们点进钓鱼网站，提交Twitter的账户信息。</strong
        >
    </p>
    <p>
        <a href="https://laod.cn/wp-content/uploads/2015/03/vinecom.png"
            ><noscript
                ><img
                    class="aligncenter wp-image-417 size-full"
                    title="vine.com"
                    src="https://laod.cn/wp-content/uploads/2015/03/vinecom.png"
                    alt="vine.com"
                    width="733"
                    height="372" /></noscript
            ><img
                class="aligncenter wp-image-417 size-full j-lazy"
                title="vine.com"
                src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20733%20372'%3E%3C/svg%3E"
                data-original="https://laod.cn/wp-content/uploads/2015/03/vinecom.png"
                alt="vine.com"
                width="733"
                height="372"
                data-lazy-src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png" /><noscript
                ><img
                    class="aligncenter wp-image-417 size-full j-lazy"
                    title="vine.com"
                    src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png"
                    data-original="https://laod.cn/wp-content/uploads/2015/03/vinecom.png"
                    alt="vine.com"
                    width="733"
                    height="372" /></noscript
        ></a>
    </p>
    <p>&nbsp;</p>
    <p>
        <strong
            >我们认为，Google应该自动帮助用户识别垃圾邮件，或者是警示从伪造的合法来源（如Google官方或者银行）发来的钓鱼信息，但是他们没有做到这些。<br />黑客通过利用这个漏洞可以就地取材，直接利用Google的服务器，给受害人发送没有任何警示信息的钓鱼邮件。</strong
        >
    </p>
    <div class="entry-copyright">
        <p>
            原创文章，作者：老D，如若转载，请注明出处：https://laod.cn/news/google-apps-for-work-vulnerability.html
        </p>
    </div>
</section>
