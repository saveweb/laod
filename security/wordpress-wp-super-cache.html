<h1 id="title">WordPress缓存插件WP-Super-Cache曝高危安全漏洞</h1>
<time id="date" datetime="2015-04-11T04:56:16+08:00">2015-04-11 04:56</time>
<section id="content">
    <p>
        <a href="https://laod.cn/wp-content/uploads/2015/04/WP-Super-Cache.jpg"
            ><noscript
                ><img
                    class="size-full wp-image-506 aligncenter"
                    src="https://laod.cn/wp-content/uploads/2015/04/WP-Super-Cache.jpg"
                    alt="WP-Super-Cache"
                    width="603"
                    height="313" /></noscript
            ><img
                class="size-full wp-image-506 aligncenter j-lazy"
                src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20603%20313'%3E%3C/svg%3E"
                data-original="https://laod.cn/wp-content/uploads/2015/04/WP-Super-Cache.jpg"
                alt="WP-Super-Cache"
                width="603"
                height="313"
                data-lazy-src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png" /><noscript
                ><img
                    class="size-full wp-image-506 aligncenter j-lazy"
                    src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png"
                    data-original="https://laod.cn/wp-content/uploads/2015/04/WP-Super-Cache.jpg"
                    alt="WP-Super-Cache"
                    width="603"
                    height="313" /></noscript
        ></a>
    </p>
    <p>
        <span style="color: #008000"
            ><strong
                >流行WordPress缓存插件WP-Super-Cache近日曝出高危漏洞，攻击者可在页面中注入恶意代码，这使得数百万WordPress网站处于危险之中。</strong
            ></span
        >
    </p>
    <p>
        <span style="color: #3366ff"
            ><strong
                >WP&nbsp;Super&nbsp;Cache是一个经典的老牌且好用的缓存插件，可以大大提高网站性能，所以一直都是WPer们几乎必装的东东之一。当然，本站也不例外。</strong
            ></span
        >
    </p>
    <p><strong>漏洞详情</strong></p>
    <p>
        <strong
            >攻击者可以使用一个精心构造的查询语句向插件缓存文件列表页面中插入恶意脚本。为了能够保证正常显示内容，页面会请求一个有效的随机数（nonce），这种情况下就需要网站管理员手动检查该特殊会话了。</strong
        >
    </p>
    <p>
        <span style="color: #ff0000"
            >注入的恶意脚本会执行一系列恶劣且猥琐的事情，比如添加一个管理员账户、注入后门等。</span
        >
    </p>
    <p>
        网站管理员们经常会使用WP-Super-Cache文件的密钥来选择合适的缓存文件进行加载，而该漏洞正好是存在WP-Super-Cache显示缓存文件密钥信息的过程中，所以该漏洞的危害很大。
    </p>
    <p>
        <a href="https://laod.cn/wp-content/uploads/2015/04/密钥信息.png"
            ><noscript
                ><img
                    class="size-full wp-image-507 aligncenter"
                    src="https://laod.cn/wp-content/uploads/2015/04/密钥信息.png"
                    alt="密钥信息"
                    width="943"
                    height="196" /></noscript
            ><img
                class="size-full wp-image-507 aligncenter j-lazy"
                src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20943%20196'%3E%3C/svg%3E"
                data-original="https://laod.cn/wp-content/uploads/2015/04/密钥信息.png"
                alt="密钥信息"
                width="943"
                height="196"
                data-lazy-src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png" /><noscript
                ><img
                    class="size-full wp-image-507 aligncenter j-lazy"
                    src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png"
                    data-original="https://laod.cn/wp-content/uploads/2015/04/密钥信息.png"
                    alt="密钥信息"
                    width="943"
                    height="196" /></noscript
        ></a>
    </p>
    <p>&nbsp;</p>
    <p>如上图显示&nbsp;$details[ ‘key’ ]字段被插入进了页面代码中。</p>
    <p>
        <a
            href="https://laod.cn/wp-content/uploads/2015/04/get_wp_cache_key-函数.png"
            ><noscript
                ><img
                    class="size-full wp-image-508 aligncenter"
                    src="https://laod.cn/wp-content/uploads/2015/04/get_wp_cache_key-函数.png"
                    alt="get_wp_cache_key() 函数"
                    width="979"
                    height="108" /></noscript
            ><img
                class="size-full wp-image-508 aligncenter j-lazy"
                src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20979%20108'%3E%3C/svg%3E"
                data-original="https://laod.cn/wp-content/uploads/2015/04/get_wp_cache_key-函数.png"
                alt="get_wp_cache_key() 函数"
                width="979"
                height="108"
                data-lazy-src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png" /><noscript
                ><img
                    class="size-full wp-image-508 aligncenter j-lazy"
                    src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png"
                    data-original="https://laod.cn/wp-content/uploads/2015/04/get_wp_cache_key-函数.png"
                    alt="get_wp_cache_key() 函数"
                    width="979"
                    height="108" /></noscript
        ></a>
    </p>
    <p>&nbsp;</p>
    <p>
        如果$details变量的‘key’参数中包含了get_wp_cache_key()&nbsp;函数的返回（也就是用户cookies中的数据），那么攻击者就可在页面中插入恶意脚本。
    </p>
    <p><strong>安全建议</strong></p>
    <p>
        建议使用了WP-Super-Cache的WordPress网站管理员尽快升级该插件至1.4.4版本，本站已早早升级。
    </p>
    <div class="entry-copyright">
        <p>
            原创文章，作者：老D，如若转载，请注明出处：https://laod.cn/security/wordpress-wp-super-cache.html
        </p>
    </div>
</section>
