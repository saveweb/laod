<h1 id="title">
    WiFi已不在安全 WPA2安全协议惊现高危漏洞
    几乎涉及所有WiFi设备（附固件升级列表）
</h1>
<time id="date" datetime="2017-10-17T19:07:17+08:00">2017-10-17 19:07</time>
<section id="content">
    <p>
        <b
            >近日，鲁汶大学的研究人员 Mathy Vanhoef 在 WPA2
            协议中发现了严重的安全漏洞，这对无线网络的安全造成了极大的考验。本文简要介绍了此次攻击的技术原理、演示视频、附件升级列表和安全从业人员对此事的看法与建议。</b
        >
    </p>
    <p>WPA2：</p>
    <blockquote>
        <p>
            Wi-Fi Protected Access II 协议，该协议被广泛用来保护现有的 WiFi
            网络，已经有13年历史之久。
        </p>
    </blockquote>
    <p>&nbsp;</p>
    <h4>KRACK 是什么</h4>
    <p>
        <a href="https://laod.cn/wp-content/uploads/2017/10/KRACK.png"
            ><noscript
                ><img
                    class="alignnone size-full wp-image-4096"
                    src="https://laod.cn/wp-content/uploads/2017/10/KRACK.png"
                    alt="KRACK"
                    width="1250"
                    height="460" /></noscript
            ><img
                class="alignnone size-full wp-image-4096 j-lazy"
                src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%201250%20460'%3E%3C/svg%3E"
                data-original="https://laod.cn/wp-content/uploads/2017/10/KRACK.png"
                alt="KRACK"
                width="1250"
                height="460"
                data-lazy-src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png" /><noscript
                ><img
                    class="alignnone size-full wp-image-4096 j-lazy"
                    src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png"
                    data-original="https://laod.cn/wp-content/uploads/2017/10/KRACK.png"
                    alt="KRACK"
                    width="1250"
                    height="460" /></noscript
        ></a>
    </p>
    <p>
        攻击者可以利用 KRACK
        攻击读取先前认为是安全的敏感信息，如信用卡号，密码，聊天信息，电子邮件，照片等。进行一些网络配置之后，它还可以注入和操作数据。例如，攻击者可以将
        ransomware 等恶意软件注入到网站中。
    </p>
    <p>KRACK ：</p>
    <blockquote><p>key reinstallation attacks</p></blockquote>
    <p>
        其实造成如此大危害的根本原因还是在于&nbsp;<strong>WiFi 标准本身</strong
        >，而不是出现了多高超的技术和工具。
    </p>
    <h4>几乎所有的 WiFi 设备都会受到影响</h4>
    <p>研究人员表示，任何使用 WPA2 协议的设备都会受到影响：</p>
    <blockquote>
        <p>1 .WPA1 和 WPA2</p>
        <p>2 .个人网络和企业网络</p>
        <p>3 .加密方式：WPA-TKIP, AES-CCMP, and GCMP</p>
    </blockquote>
    <p>
        <strong
            >简单的说，如果你的设备可以使用 WiFi，那就很可能会受到影响。</strong
        >
    </p>
    <p>
        而且，研究人员初步发现，Android，Linux，Apple，Windows，OpenBSD，联发科，Linksys
        设备都会受到影响。
    </p>
    <p>
        值得注意的是，KRACK 攻击并不会帮助攻击者知晓攻击目标的 WiFi
        密码；相反，他们直接可以对数据进行解密，而不需要知晓或破解实际密码。
    </p>
    <p>所以，简单改变 WiFi 密码是不能防御此次攻击的。</p>
    <h4>KRACK 工作原理</h4>
    <p>
        Mathy Vanhoef 发现，在对流量进行加密的过程中，需要创建一个密钥，而 KRACK
        攻击正是利用了此过程中 WPA2 协议中的四次握手存在漏洞。
    </p>
    <p>
        攻击者若想成功使用 KRACK
        ，他需要通过操纵并重播加密的握手信息来诱骗受害者重新生成密钥，
    </p>
    <p>
        当受害者重新安装密钥时，相关参数，如增加的数据包号码（即随机数）和接收的数据包号码（即重播计数器）将会被重置为初试值
    </p>
    <p>
        为了保证安全性，只能生成和使用一次密钥，不幸的是，WPA2协议并不能保证这一点，通过操纵握手时的加密信息，攻击者可以在实践中利用这个弱点。
    </p>
    <p>有中国黑客教父之称的 goodwell 对此分析道：</p>
    <blockquote>
        <p>
            这个KRACK
            ATTACK攻击应该是目前最取巧的针对WPA/WPA2的中间人攻击方法。这一攻击并不针对WPA加密本身，而是通过多次重播四次握手的信息3，来强制复位client本地保存的WPA2密钥，即把原来正确真实的WPA密码替换掉，不破解直接替换成全0密钥，这样就可以将受害者连到伪造的AP上，无需任何提示。再配合SSLStrip之类的工具做中间人，就圆满地实现了基于WIFI的无缝中间人攻击。
        </p>
    </blockquote>
    <p><strong>演示视频：</strong></p>
    <p>
        <a
            href="https://v.qq.com/x/page/n0561jxzagv.html"
            target="_blank"
            rel="noopener"
            >https://v.qq.com/x/page/n0561jxzagv.html</a
        >
    </p>
    <p>&nbsp;</p>
    <p>
        Mathy Vanhoef 的团队已经成功对安卓智能手机进行了 KRACK
        攻击，视频中演示了受害者在受保护的 WiFi
        网络中传输的数据是如何被攻击者解密的。
    </p>
    <p><strong>研究人员表示：</strong></p>
    <blockquote>
        <p>
            KRACK 攻击会导致数据传输异常（ packet numbers or initialization
            vectors
            被重置），所以对数据包进行解密是可以实现的。所以，使用相同的加密密钥已经是过时的做法了。
        </p>
    </blockquote>
    <p>
        KRACK 攻击可能会对 Linux 和 Android 6.0 或更高版本造成更大的破坏。因为
    </p>
    <p>
        攻击者可以“欺骗” Android and Linux
        设备<strong>将加密密钥都重置为0</strong>。
    </p>
    <h4>受影响的漏洞</h4>
    <p>
        其实早在去年的时候，Vanhoef
        就发现了这个问题，但他一直在改善他的研究。今年7月，研究人员陆续向一些受影响的供应商发送通知，美国的
        CERT 也在8月底的时候通知了更多的供应商。
    </p>
    <p>
        研究人员在针对<a href="https://www.krackattacks.com/">网站</a>的 KRACK
        攻击做了更多的研究，他们打算在今年的计算机和通信安全会议（CCS）和欧洲黑帽大会上介绍他们的研究成果。
    </p>
    <p>
        <strong
            >以下的 CVE
            标识可以帮助用户知晓自己的设备是否已经有安全更新：</strong
        >
    </p>
    <blockquote>
        <ul>
            <li>
                <a href="https://nvd.nist.gov/vuln/detail/CVE-2017-13077"
                    >CVE-2017-13077</a
                >: Reinstallation of the pairwise encryption key (PTK-TK) in the
                4-way handshake.
            </li>
            <li>
                <a href="https://nvd.nist.gov/vuln/detail/CVE-2017-13078"
                    >CVE-2017-13078</a
                >: Reinstallation of the group key (GTK) in the 4-way handshake.
            </li>
            <li>
                <a href="https://nvd.nist.gov/vuln/detail/CVE-2017-13079"
                    >CVE-2017-13079</a
                >: Reinstallation of the integrity group key (IGTK) in the 4-way
                handshake.
            </li>
            <li>
                <a href="https://nvd.nist.gov/vuln/detail/CVE-2017-13080"
                    >CVE-2017-13080</a
                >: Reinstallation of the group key (GTK) in the group key
                handshake.
            </li>
            <li>
                <a href="https://nvd.nist.gov/vuln/detail/CVE-2017-13081"
                    >CVE-2017-13081</a
                >: Reinstallation of the integrity group key (IGTK) in the group
                key handshake.
            </li>
            <li>
                <a href="https://nvd.nist.gov/vuln/detail/CVE-2017-13082"
                    >CVE-2017-13082</a
                >: Accepting a retransmitted Fast BSS Transition (FT)
                Reassociation Request and reinstalling the pairwise encryption
                key (PTK-TK) while processing it.
            </li>
            <li>
                <a href="https://nvd.nist.gov/vuln/detail/CVE-2017-13084"
                    >CVE-2017-13084</a
                >: Reinstallation of the STK key in the PeerKey handshake.
            </li>
            <li>
                <a href="https://nvd.nist.gov/vuln/detail/CVE-2017-13086"
                    >CVE-2017-13086</a
                >: reinstallation of the Tunneled Direct-Link Setup (TDLS)
                PeerKey (TPK) key in the TDLS handshake.
            </li>
            <li>
                <a href="https://nvd.nist.gov/vuln/detail/CVE-2017-13087"
                    >CVE-2017-13087</a
                >: reinstallation of the group key (GTK) when processing a
                Wireless Network Management (WNM) Sleep Mode Response frame.
            </li>
            <li>
                <a href="https://nvd.nist.gov/vuln/detail/CVE-2017-13088"
                    >CVE-2017-13088</a
                >: reinstallation of the integrity group key (IGTK) when
                processing a Wireless Network Management (WNM) Sleep Mode
                Response frame.
            </li>
        </ul>
    </blockquote>
    <p>&nbsp;</p>
    <h4>固件升级列表</h4>
    <p>
        <a href="https://laod.cn/wp-content/uploads/2017/10/wpa_supplicant.png"
            ><noscript
                ><img
                    class="alignnone size-full wp-image-4097"
                    src="https://laod.cn/wp-content/uploads/2017/10/wpa_supplicant.png"
                    alt="wpa_supplicant"
                    width="1269"
                    height="370" /></noscript
            ><img
                class="alignnone size-full wp-image-4097 j-lazy"
                src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%201269%20370'%3E%3C/svg%3E"
                data-original="https://laod.cn/wp-content/uploads/2017/10/wpa_supplicant.png"
                alt="wpa_supplicant"
                width="1269"
                height="370"
                data-lazy-src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png" /><noscript
                ><img
                    class="alignnone size-full wp-image-4097 j-lazy"
                    src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png"
                    data-original="https://laod.cn/wp-content/uploads/2017/10/wpa_supplicant.png"
                    alt="wpa_supplicant"
                    width="1269"
                    height="370" /></noscript
        ></a>
    </p>
    <p>
        为了保护无线安全，许多 WiFi 产品供应商都为其产品发布了
        最新的固件更新和驱动程序。在这里也强烈建议大家抓紧时间更新硬件。
    </p>
    <p>以下是关于大部分 WiFi 产品供应商提供更新的信息：</p>
    <h3>Arch Linux</h3>
    <p>
        Arch 推出了 wpa_supplicant 和 hostapd 的更新。补丁在<a
            href="https://git.archlinux.org/svntogit/packages.git/commit/trunk?h=packages/wpa_supplicant&amp;id=9c1bda00a846ff3b60e7c4b4f60b28ff4a8f7768"
            >这里</a
        >。
    </p>
    <h3>Amazon</h3>
    <p>
        亚马逊对此回应道：“我们正在找寻涉及此漏洞的设备，并在必要的时候发布补丁”。
    </p>
    <h3>Apple</h3>
    <p>
        根据&nbsp;<a
            href="http://appleinsider.com/articles/17/10/16/apple-confirms-krack-wi-fi-wpa-2-attack-vector-patched-in-ios-tvos-watchos-macos-betas"
            >article at AppleInsider</a
        >&nbsp;中的文章：
    </p>
    <blockquote>
        <p>
            据苹果内部的消息，此漏洞已经在“以前”的 beta
            版本中修复过了，这意味着<a
                href="http://appleinsider.com/articles/17/10/16/apple-issues-third-developer-betas-of-ios-111-watchos-41-and-tvos-111"
                >周一前</a
            >就发布过了。不过，对于AirPort硬件，包括Time Machine，AirPort
            Extreme基站和AirPort
            Express都没有可用的补丁，并不确定是否正在着手修复中。
        </p>
    </blockquote>
    <h3>Aruba Networks</h3>
    <p>
        补丁信息可以在<a
            href="http://www.arubanetworks.com/assets/alert/ARUBA-PSA-2017-007.txt"
            >这里</a
        >找到。<a
            href="http://www.arubanetworks.com/assets/alert/ARUBA-PSA-2017-007_FAQ_Rev-1.pdf"
            >FAQ</a
        >&nbsp;在已经发布。
    </p>
    <h3>Belkin, Linksys, and Wemo</h3>
    <blockquote>
        <p>
            Belkin Linksys 和 Wemo 都已经知晓了 WPA
            漏洞，我们的安全团队正在调查更多的细节，我们将会不久提出相应建议。我们一向将用户放在第一位，并且会在我们的安全建议页面上更新相应教程来告知用户如何更新产品。
        </p>
    </blockquote>
    <h3>Cisco</h3>
    <p>
        思科已经发布了一份<a
            href="https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20171016-wpa"
            >报告</a
        >，讨论产品漏洞和易受攻击的产品列表。思科表示， 正在开发 IOS
        和驱动的更新，马上就可以发布，建议思科的产品用户经常检查报告页面，可以第一时间安装更新。
    </p>
    <h3>Debian</h3>
    <p>
        Debian发布了一份<a
            href="https://lists.debian.org/debian-security-announce/2017/msg00261.html"
            >报告</a
        >，其中包含了对于 Krack 漏洞的更新情况。
    </p>
    <h3>Dell</h3>
    <p>
        戴尔发言人表示，他们正在积极研究该漏洞，并在接下来的几天时间里给出建议。
    </p>
    <h3>FreeBSD</h3>
    <p>
        根据 CERT 的信息，FreeBSD 已经意识到了这个漏洞，并建议用户查看&nbsp;<a
            href="https://lists.freebsd.org/mailman/listinfo/freebsd-announce"
            >FreeBSD-Announce mailing list</a
        >&nbsp;和&nbsp;<a href="https://www.freebsd.org/security/"
            >Security Information page</a
        >。
    </p>
    <h3>Google</h3>
    <blockquote>
        <p>我们已经意识到了这个问题，并会在接下来的几周内推出安全补丁。</p>
    </blockquote>
    <p>而对于 Google WiFi 则没有更多的信息。</p>
    <h3>Intel</h3>
    <p>
        Intel 也已经发布了相应<a
            href="https://security-center.intel.com/advisory.aspx?intelid=INTEL-SA-00101&amp;languageid=en-fr"
            >报告</a
        >，里面包含驱动更新的相关信息。
    </p>
    <h3>Linux</h3>
    <p>已发布<a href="https://w1.fi/security/2017-1/">补丁</a></p>
    <h3>Microsoft</h3>
    <p>
        微软在上周二（10月10号）的补丁中就<a
            href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-13080"
            >修复</a
        >了这个漏洞。
    </p>
    <h3>OpenBSD</h3>
    <p>
        已提供安全补丁，更多信息<a href="https://www.krackattacks.com/#paper"
            >在此</a
        >。
    </p>
    <h3>Red Hat</h3>
    <p>
        Red Hat 已经发布了关于漏洞中关于 wpa_supplicant 的相关<a
            href="https://access.redhat.com/security/cve/cve-2017-13077"
            >报告</a
        >。
    </p>
    <h3>TP-Link</h3>
    <blockquote>
        <p>
            我们的工程师正在全力解决这个问题，目前我们还没有收到关于
            TP-Link产品受到影响的信息，我们会持续在官网上更新最新进展。
        </p>
    </blockquote>
    <h3>Ubuntu</h3>
    <p>
        Ubuntu 已经发布了有关更新 wpa_supplicant 和 hostapd 的<a
            href="https://usn.ubuntu.com/usn/usn-3455-1/"
            >报告</a
        >。
    </p>
    <h3>WatchGuard</h3>
    <p>
        已发布相关<a
            href="https://www.watchguard.com/wgrd-blog/wpa-and-wpa2-vulnerabilities-update"
            >报告</a
        >。
    </p>
    <h3>WiFi Alliance Announcement</h3>
    <p>
        已发布相关<a href="https://www.wi-fi.org/security-update-october-2017"
            >声明</a
        >。
    </p>
    <h3>表示不会受到 Krack 影响的公司</h3>
    <blockquote>
        <p>Arista Networks,</p>
        <p>Inc.LenovoVmware</p>
    </blockquote>
    <h3>未提供相关信息的公司</h3>
    <blockquote>
        <p>Juniper Networks</p>
        <p>3com Inc</p>
        <p>Actiontec</p>
        <p>Alcatel-Lucent</p>
        <p>AsusTek Computer Inc</p>
        <p>Atheros Communications, Inc.</p>
        <p>Barracuda Networks</p>
        <p>Broadcom</p>
        <p>CentOS</p>
        <p>D-Link Systems, Inc.</p>
        <p>EdimaxEMC</p>
        <p>CorporationExtreme Networks</p>
        <p>F5 Networks, Inc.</p>
        <p>Foundry Brocade</p>
        <p>Hewlett Packard Enterprise</p>
        <p>IBM, INC.</p>
        <p>Kyocera Communications</p>
        <p>Marvell Semiconductor</p>
        <p>MediaTek</p>
    </blockquote>
    <h4>个人如何应对</h4>
    <p>
        对于个人来说，其实没必要太多惊慌，因为这次攻击的影响范围还是有限的，因为攻击者<strong>需要在物理上接近被攻击网络</strong>。
    </p>
    <p>
        安全专家指出，普通用户目前能做的事情也只有安心等待了，建议大家近期多关注路由器控制面板里的检查更新，也可以去路由器厂商的网站看看有没有更新固件。
    </p>
    <p>360 安全研究员杨卿对此提出安全建议：</p>
    <blockquote>
        <p>
            1.及时更新无线路由器、手机，智能硬件等所有使用WPA2无线认证客户端的软件版本。（有补丁的前提下）
        </p>
        <p>
            2.有条件的企业及个人请合理部署WIPS，及时监测合法WiFi区域内的恶意钓鱼WiFi，并加以阻断干扰，使其恶意WiFi无法正常工作。（WIPS的重要性）
        </p>
        <p>
            3.无线通信连接使用VPN加密隧道及强制SSL规避流量劫持与中间人攻击造成的信息泄漏。
        </p>
        <p>4.国标WAPI无线认证暂不受该漏洞影响。</p>
    </blockquote>
    <p>参考链接：</p>
    <div class="entry-copyright">
        <p>
            原创文章，作者：老D，如若转载，请注明出处：https://laod.cn/security/wifi-wpa2.html
        </p>
    </div>
</section>
