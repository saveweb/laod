<h1 id="title">Google Chrome QUIC 白名单添加方法</h1>
<time id="date" datetime="2018-11-13T15:15:17+08:00">2018-11-13 15:15</time>
<section id="content">
    <p>
        本文来自：<a
            href="https://github.com/googlehosts/hosts/wiki/Google-Chrome-QUIC-%E7%99%BD%E5%90%8D%E5%8D%95%E6%B7%BB%E5%8A%A0%E6%96%B9%E6%B3%95"
            target="_blank"
            rel="noopener"
            >Google Hosts</a
        >
    </p>
    <ul>
        <li>
            截止到2018年11月7日，本教程仅适用于以下 Google 相关域名：[code]<span
                style="color: #ff0000"
                >www.google.com.hk</span
            >[/code]
        </li>
    </ul>
    <ul>
        <li>
            由于 Apple 的限制，以上域名在 iOS 平台一律无法使用，本教程亦不适用于
            iOS 平台。
        </li>
        <li>请确保您已更新 hosts 至最新版。</li>
        <li>
            请确保您的 Google Chrome 为官方原装完整版，版本为 55
            或更高，并已经访问过&nbsp;[code]chrome://flags/#enable-quic[/code]&nbsp;将
            Experimental QUIC protocol 设置为 Enabled。<strong
                >Chromium 以及任何基于 Chromium
                开发的其他浏览器，由于默认配置以及可能的功能删减问题，我们不提供任何支持（即便它们理论上也可访问）。为保证测试效果，请使用官方渠道下载安装的
                Google Chrome 进行测试。</strong
            ><a
                href="https://www.google.cn/chrome/"
                target="_blank"
                rel="nofollow noopener"
                >点此下载最新版 Google Chrome</a
            >
        </li>
        <li>如您不需要使用所有域名，请自行删减命令行参数。</li>
    </ul>
    <h2>
        <a
            id="user-content-tldr"
            class="anchor"
            href="https://github.com/googlehosts/hosts/wiki/Google-Chrome-QUIC-%E7%99%BD%E5%90%8D%E5%8D%95%E6%B7%BB%E5%8A%A0%E6%96%B9%E6%B3%95#tldr"
            aria-hidden="true"
        ></a
        >TL;DR
    </h2>
    <p>
        [code]google-chrome –quic-host-whitelist=”https://www.google.com.hk”
        –origin-to-force-quic-on=www.google.com.hk:443
        “https://www.google.com.hk”[/code]
    </p>
    <h2>
        <a
            id="user-content-windows"
            class="anchor"
            href="https://github.com/googlehosts/hosts/wiki/Google-Chrome-QUIC-%E7%99%BD%E5%90%8D%E5%8D%95%E6%B7%BB%E5%8A%A0%E6%96%B9%E6%B3%95#windows"
            aria-hidden="true"
        ></a
        >Windows
    </h2>
    <ol>
        <li>
            找到 Google Chrome 的快捷方式。如果没有，请找到 Google Chrome
            的安装目录，右键 chrome.exe 并新建一个。
        </li>
        <li>右键单击快捷方式，选择“属性”→“快捷方式”选项卡。</li>
    </ol>
    <p>
        <a href="https://laod.cn/wp-content/uploads/2018/11/win.png"
            ><noscript
                ><img
                    class="alignnone size-full wp-image-5475"
                    src="https://laod.cn/wp-content/uploads/2018/11/win.png"
                    alt="chrome.exe"
                    width="421"
                    height="651" /></noscript
            ><img
                class="alignnone size-full wp-image-5475 j-lazy"
                src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20421%20651'%3E%3C/svg%3E"
                data-original="https://laod.cn/wp-content/uploads/2018/11/win.png"
                alt="chrome.exe"
                width="421"
                height="651"
                data-lazy-src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png" /><noscript
                ><img
                    class="alignnone size-full wp-image-5475 j-lazy"
                    src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png"
                    data-original="https://laod.cn/wp-content/uploads/2018/11/win.png"
                    alt="chrome.exe"
                    width="421"
                    height="651" /></noscript
        ></a>
    </p>
    <p>
        3.
        找到“目标”文本框，在原有内容的<strong>后面</strong>粘贴如下内容（注意<strong>不是替换</strong>以及<strong>开头的空格</strong>）：
    </p>
    <p>
        [code] –quic-host-whitelist=”https://www.google.com.hk”
        –origin-to-force-quic-on=www.google.com.hk:443
        “https://www.google.com.hk”[/code]
    </p>
    <p>例如，原先的内容是</p>
    <p>
        [code]”C:\Program Files
        (x86)\Google\Chrome\Application\chrome.exe”[/code]
    </p>
    <p>则修改后的内容应为</p>
    <p>
        [code]”C:\Program Files (x86)\Google\Chrome\Application\chrome.exe”
        –quic-host-whitelist=”https://www.google.com.hk”
        –origin-to-force-quic-on=www.google.com.hk:443
        “https://www.google.com.hk”[/code]
    </p>
    <p>
        <a href="https://laod.cn/wp-content/uploads/2018/11/w2.png"
            ><noscript
                ><img
                    class="alignnone size-full wp-image-5476"
                    src="https://laod.cn/wp-content/uploads/2018/11/w2.png"
                    alt="Google"
                    width="421"
                    height="651" /></noscript
            ><img
                class="alignnone size-full wp-image-5476 j-lazy"
                src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20421%20651'%3E%3C/svg%3E"
                data-original="https://laod.cn/wp-content/uploads/2018/11/w2.png"
                alt="Google"
                width="421"
                height="651"
                data-lazy-src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png" /><noscript
                ><img
                    class="alignnone size-full wp-image-5476 j-lazy"
                    src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png"
                    data-original="https://laod.cn/wp-content/uploads/2018/11/w2.png"
                    alt="Google"
                    width="421"
                    height="651" /></noscript
        ></a>
    </p>
    <p>
        5. 如果此时仍有打开的 Google Chrome 窗口或任何 Google Chrome
        进程（包括后台进程），<strong>请全部关闭（必要时请重启系统）</strong>，然后使用此快捷方式启动
        Google Chrome。
    </p>
    <h2>
        <a
            id="user-content-android"
            class="anchor"
            href="https://github.com/googlehosts/hosts/wiki/Google-Chrome-QUIC-%E7%99%BD%E5%90%8D%E5%8D%95%E6%B7%BB%E5%8A%A0%E6%96%B9%E6%B3%95#android"
            aria-hidden="true"
        ></a
        >Android
    </h2>
    <ol>
        <li>
            访问&nbsp;[code]chrome://flags/#enable-command-line-on-non-rooted-devices[/code]&nbsp;并将高亮选项（Enable
            command line on non-rooted devices）设置为 Enabled。
        </li>
        <li>如果您的设备：</li>
    </ol>
    <ul>
        <li>
            已 ROOT：
            <ol>
                <li>
                    使用支持 ROOT
                    权限访问的文件浏览器在&nbsp;&nbsp;[code]/data/local/tmp/[/code]目录下创建一个名为&nbsp;[code]chrome-command-line[/code]&nbsp;的文件。
                </li>
                <li>
                    粘贴如下内容并保存文件：[code]google-chrome
                    –quic-host-whitelist=”https://www.google.com.hk”
                    –origin-to-force-quic-on=www.google.com.hk:443
                    “https://www.google.com.hk”[/code]
                </li>
            </ol>
        </li>
        <li>
            未 ROOT，但是有带终端的第三方 recovery（例如 TWRP）：<br />
            重启设备进入 recovery 并打开终端，确保 /data
            分区已正确挂载，然后执行如下命令并重启：[code]echo ‘google-chrome
            –quic-host-whitelist=\”https://www.google.com.hk\”
            –origin-to-force-quic-on=www.google.com.hk:443
            \”https://www.google.com.hk\”‘ &gt;
            /data/local/tmp/chrome-command-line[/code]
        </li>
        <li>
            未 ROOT，也没有带终端的第三方 recovery：
            <ol>
                <li>启用系统设置的“开发者选项”并启用其中的“USB 调试”。</li>
                <li>在电脑上安装好 ADB 和相应的驱动。</li>
                <li>
                    将设备连接至电脑，并在设备上同意授权（如果有），然后打开命令行窗口或终端并执行如下命令：[code]adb
                    shell “echo ‘google-chrome
                    –quic-host-whitelist=\”https://www.google.com.hk\”
                    –origin-to-force-quic-on=www.google.com.hk:443
                    \”https://www.google.com.hk\”‘ &gt;
                    /data/local/tmp/chrome-command-line”[/code]
                </li>
            </ol>
        </li>
    </ul>
    <ol start="3">
        <li><strong>强制终止 Google Chrome 应用</strong>，然后再次启动它。</li>
    </ol>
    <h3>
        <a
            id="user-content-问题诊断"
            class="anchor"
            href="https://github.com/googlehosts/hosts/wiki/Google-Chrome-QUIC-%E7%99%BD%E5%90%8D%E5%8D%95%E6%B7%BB%E5%8A%A0%E6%96%B9%E6%B3%95#%E9%97%AE%E9%A2%98%E8%AF%8A%E6%96%AD"
            aria-hidden="true"
        ></a
        >问题诊断
    </h3>
    <ol>
        <li>
            提示“您目前处于离线状态”<br />
            请使用其他页面进行测试，例如<a
                href="https://www.google.com.hk/teapot"
                target="_blank"
                rel="nofollow noopener"
                >这个页面</a
            >（直连成功后可以看见一个茶壶）。成功直连后再测试搜索。
        </li>
        <li>
            错误代码 ERR_CONNECTION_RESET<br />
            访问&nbsp;[code]chrome://version[/code]&nbsp;并检查 Command Line
            一行是否含有上述命令中出现的命令行参数（您应该可以看到诸如[code]–quic-host-[/code]&nbsp;&nbsp;[code]whitelist=https://www.google.com.hk[/code]&nbsp;之类的字样）。只有在正确显示命令行参数之后才可直连。如果您已正确执行上述命令且没有报错，但命令行参数没有显示，请再次尝试强制终止应用并启动。
        </li>
        <li>
            错误代码 ERR_QUIC_PROTOCOL_ERROR<br />
            请确保 hosts 已更新至最新版。
        </li>
    </ol>
    <div class="entry-copyright">
        <p>
            原创文章，作者：老D，如若转载，请注明出处：https://laod.cn/black-technology/google-chrome-quic.html
        </p>
    </div>
</section>
