<h1 id="title">给博客加上 Hitokoto·一言经典语句</h1>
<time id="date" datetime="2017-10-31T21:28:43+08:00">2017-10-31 21:28</time>
<section id="content">
    <p>
        <a href="https://laod.cn/wp-content/uploads/2017/10/yiyan0.jpg"
            ><noscript
                ><img
                    class="alignnone size-full wp-image-4197"
                    src="https://laod.cn/wp-content/uploads/2017/10/yiyan0.jpg"
                    alt="Hitokoto"
                    width="856"
                    height="556" /></noscript
            ><img
                class="alignnone size-full wp-image-4197 j-lazy"
                src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20856%20556'%3E%3C/svg%3E"
                data-original="https://laod.cn/wp-content/uploads/2017/10/yiyan0.jpg"
                alt="Hitokoto"
                width="856"
                height="556"
                data-lazy-src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png" /><noscript
                ><img
                    class="alignnone size-full wp-image-4197 j-lazy"
                    src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png"
                    data-original="https://laod.cn/wp-content/uploads/2017/10/yiyan0.jpg"
                    alt="Hitokoto"
                    width="856"
                    height="556" /></noscript
        ></a>
    </p>
    <p>Hitokoto·一言是什么？</p>
    <p>官方的自我介绍如下：<br />[v_warn]</p>
    <p>
        一言网(Hitokoto.cn)创立于2016年，隶属于萌创Team，目前网站主要提供一句话服务。
    </p>
    <p>
        动漫也好、小说也好、网络也好，不论在哪里，我们总会看到有那么一两个句子能穿透你的心。我们把这些句子汇聚起来，形成一言网络，以传递更多的感动。如果可以，我们希望我们没有停止服务的那一天。
    </p>
    <p>
        简单来说，一言指的就是一句话，可以是动漫中的台词，也可以是网络上的各种小段子。<br />或是感动，或是开心，有或是单纯的回忆。来到这里，留下你所喜欢的那一句句话，与大家分享，这就是一言存在的目的。<br />[/v_warn]
    </p>
    <p><strong>效果图：</strong></p>
    <p>
        <a href="https://laod.cn/wp-content/uploads/2017/10/YIYANG.png"
            ><noscript
                ><img
                    class="alignnone size-full wp-image-4195"
                    src="https://laod.cn/wp-content/uploads/2017/10/YIYANG.png"
                    alt="一言经典语句"
                    width="785"
                    height="220" /></noscript
            ><img
                class="alignnone size-full wp-image-4195 j-lazy"
                src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20785%20220'%3E%3C/svg%3E"
                data-original="https://laod.cn/wp-content/uploads/2017/10/YIYANG.png"
                alt="一言经典语句"
                width="785"
                height="220"
                data-lazy-src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png" /><noscript
                ><img
                    class="alignnone size-full wp-image-4195 j-lazy"
                    src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png"
                    data-original="https://laod.cn/wp-content/uploads/2017/10/YIYANG.png"
                    alt="一言经典语句"
                    width="785"
                    height="220" /></noscript
        ></a>
    </p>
    <h4>一、直接调用他人的接口</h4>
    <p><strong>数据获取</strong></p>
    <ul>
        <li>请求地址:https://api.lwl12.com/hitokoto/main/get</li>
        <li>请求方式:GET</li>
        <li>请求参数:</li>
        <li>charset:字符集，支持gbk/utf-8，默认为utf-8</li>
        <li>encode数据格式，对应如下</li>
        <li>js返回函数名为lwlhitokoto的JavaScript脚本，用于同步调用</li>
        <li>arl:刷新时间，单位ms</li>
    </ul>
    <p>
        <strong>实例</strong
        ><br />请求https://api.lwl12.com/hitokoto/main/get<br />返回&nbsp;呐，知道么，樱花飘落的速度，是每秒五厘米哦~
    </p>
    <p>&nbsp;</p>
    <p>
        <strong>调用举例 – JavaScript + HTML</strong
        ><br />脚本地址https://api.lwl12.com/hitokoto/main/get?encode=js
    </p>
    <p>&nbsp;</p>
    <p>
        <strong>使用方法</strong
        ><br />将下面这段代码放入页面内需要展示一句话的位置即可
    </p>
    <pre>
&lt;script&nbsp;type="text/javascript"&nbsp;src="https://api.lwl12.com/hitokoto/main/get?encode=js&amp;charset=utf-8"&gt;&lt;/script&gt;&lt;div&nbsp;id="lwlhitokoto"&gt;&lt;script&gt;lwlhitokoto()&lt;/script&gt;&lt;/div&gt;</pre
    >
    <p>&nbsp;</p>
    <h4>二、自己DIY部署</h4>
    <pre>
&lt;?php
//获取句子文件的绝对路径
//如果你介意别人可能会拖走这个文本，可以把文件名自定义一下，或者通过Nginx禁止拉取也行。
$path = dirname(__FILE__);
$file = file($path."/yiyan.txt");
//随机读取一行
$arr  = mt_rand( 0, count( $file ) - 1 );
$content  = trim($file[$arr]);
//编码判断，用于输出相应的响应头部编码
if (isset($_GET['charset']) &amp;&amp; !emptyempty($_GET['charset'])) {
    $charset = $_GET['charset'];
    if (strcasecmp($charset,"gbk") == 0 ) {
        $content = mb_convert_encoding($content,'gbk', 'utf-8');
    }
} else {
    $charset = 'utf-8';
}
header("Content-Type: text/html; charset=$charset");
//格式化判断，输出js或纯文本
if ($_GET['format'] === 'js') {
    echo "function hitokoto(){document.write('" . $content ."');}";
} else {
    echo $content;
}</pre
    >
    <p>
        以上代码保存为<strong>index.php</strong>，然后上传到网站根目录下的<strong>yiyan</strong>文件夹（这个自己随机定义）最后，下载<strong>yiyan.txt</strong>文本文件。
    </p>
    <p>[url href=https://eyun.baidu.com/s/3o7RkIhW]提取码：laod[/url]</p>
    <p>
        把<strong>yiyan.txt</strong>上传到和index.php同级目录，比如yiyan文件夹内。<br />现在，浏览器访问
        http://你的域名/yiyan/ 就可以看到输出内容了。
    </p>
    <p>&nbsp;</p>
    <h4>三、博客部署</h4>
    <p>
        第一步我们已经完成了这个接口的自建部署，现在可以把这个功能搬到博客上了。
    </p>
    <p>
        部署方法和其他博客基本一致，非常简单，将下面两行代码添加到博客你想显示一言的位置即可：
    </p>
    <div class="dp-highlighter">
        <div class="bar"></div>
        <ol class="dp-c" start="1">
            <li class="alt">
                &lt;script&nbsp;type=<span class="string"
                    >“text/javascript”</span
                >&nbsp;src=<span class="string"
                    >“https://你的域名/yiyan/?format=js&amp;charset=utf-8”</span
                >&gt;&lt;/script&gt;
            </li>
            <li class="">
                &lt;div&nbsp;id=<span class="string">“yiyan”</span
                >&gt;&lt;script&gt;hitokoto()&lt;/script&gt;&lt;/div&gt;
            </li>
        </ol>
    </div>
    <p>这样输出的样式可能会比较丑，如果你懂CSS的话可以自己再美化美化。</p>
    <p>
        当然，Begin主题或者不会css的朋友可以先试下我这边写好的css代码（可以加到style.css）：
    </p>
    <div class="dp-highlighter">
        <div class="bar"></div>
        <ol class="dp-css" start="1">
            <li class="alt"><span class="colors">#yiyan</span>{</li>
            <li class="">
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">border-left</span
                >:&nbsp;<span class="string">5px</span>&nbsp;<span
                    class="string"
                    >solid</span
                >&nbsp;<span class="colors">#0073d8</span>;
            </li>
            <li class="alt">
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">border-right</span
                >:&nbsp;<span class="string">5px</span>&nbsp;<span
                    class="string"
                    >solid</span
                >&nbsp;<span class="colors">#0073d8</span>;
            </li>
            <li class="">
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"
                    >background-color</span
                >:&nbsp;<span class="colors">#3288d3</span>1a;
            </li>
            <li class="alt">
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">padding</span
                >:&nbsp;<span class="string">10px</span>;<span class="keyword"
                    >text-align</span
                >:&nbsp;<span class="string">center</span>;
            </li>
            <li class="">
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">color</span
                >:&nbsp;<span class="colors">#0073d8</span>;
            </li>
            <li class="alt">
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">margin</span
                >:&nbsp;<span class="string">5px</span>&nbsp;0&nbsp;<span
                    class="string"
                    >5px</span
                >&nbsp;0;
            </li>
            <li class="">}</li>
        </ol>
    </div>
    <p>
        部署完成之后，前台刷新应该就可以看到效果了，每次刷新都会随机展示一言经典句子。如果你有新的句子，也只要编辑hitokoto.txt文件加入即可。
    </p>
    <h4>四、Begin主题添加js文件</h4>
    <p>
        可能用Begin主题的童鞋不懂添加到那里，正好我也用这个主题，那么直接贴出来，或许可以减少你不少时间。
    </p>
    <p>
        老D直接插到&nbsp;<strong>begin/template/social.php </strong>如下图所示：
    </p>
    <p>
        <a href="https://laod.cn/wp-content/uploads/2017/10/yiyan-1.png"
            ><noscript
                ><img
                    class="alignnone size-full wp-image-4196"
                    src="https://laod.cn/wp-content/uploads/2017/10/yiyan-1.png"
                    alt="一言经典语句"
                    width="908"
                    height="639" /></noscript
            ><img
                class="alignnone size-full wp-image-4196 j-lazy"
                src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20908%20639'%3E%3C/svg%3E"
                data-original="https://laod.cn/wp-content/uploads/2017/10/yiyan-1.png"
                alt="一言经典语句"
                width="908"
                height="639"
                data-lazy-src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png" /><noscript
                ><img
                    class="alignnone size-full wp-image-4196 j-lazy"
                    src="https://laod.cn/wp-content/themes/justnews/themer/assets/images/lazy.png"
                    data-original="https://laod.cn/wp-content/uploads/2017/10/yiyan-1.png"
                    alt="一言经典语句"
                    width="908"
                    height="639" /></noscript
        ></a>
    </p>
    <p>
        弄完之后记得刷新缓存，不然你短时间内是看不到效果的哦，启用CDN的童鞋请也要记得给排除下这个路径缓存。
    </p>
    <p>至于别的主题你就慢慢找了，这个功能适用于绝大多数博客、网站、论坛。</p>
    <div class="entry-copyright">
        <p>
            原创文章，作者：老D，如若转载，请注明出处：https://laod.cn/page/hitokoto-yiyan.html
        </p>
    </div>
</section>
